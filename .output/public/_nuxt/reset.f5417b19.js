import{E as K,_ as B,a as N,b as O}from"./el-overlay.e224c25f.js";import"./el-button.54301017.js";import"./el-form-item.4ed993c7.js";import{E as Q,s as X,H as Y,r as c,e as ss,f as L,w as T,h as d,p as i,i as f,j as p,u as s,k as os,c as V,l as m,m as es,o as l,G as x,x as rs,y as ts,v as ns}from"./entry.3cdac9c8.js";import{_ as F}from"./lock-icon.3c6d0355.js";import{_ as as,a as is}from"./good.fceb5ca5.js";import{L as ls}from"./LoginButtons.f614cad0.js";import{E as I}from"./ErrorMassageModal.4083fc07.js";import{h as z,s as q}from"./eye-close-icon.166f07ad.js";import{_ as ds}from"./_plugin-vue_export-helper.c27b6911.js";import"./focus-trap.24649fb3.js";import"./chevron-icon.bffbf01a.js";const w=v=>(rs("data-v-8640c795"),v=v(),ts(),v),us={class:"main"},ps={class:"main__form"},ms=w(()=>i("div",{class:"main__form--title"},"Reset password",-1)),_s=w(()=>i("div",{class:"main__form--subtitle"},"Please fill the forms to reset password",-1)),ws=w(()=>i("img",{src:F,alt:"password_icon"},null,-1)),fs=w(()=>i("span",{for:"password",class:"custom_placeholder"}," Password ",-1)),cs=[fs],vs=["src"],gs={key:0,src:as,alt:""},hs={key:1,src:is,alt:""},ys={key:2,src:B,alt:""},Ss=["innerHTML"],ks={key:0,class:"el-form-item__error"},xs=["innerHTML"],$s=w(()=>i("div",null,null,-1)),bs=w(()=>i("img",{src:F,alt:"password_icon"},null,-1)),Es=w(()=>i("span",{for:"password_confirmation",class:"custom_placeholder"}," Confirm Password ",-1)),Ms=[Es],Cs=["src"],Ps={key:0,class:"el-form-item__error"},Ls=["innerHTML"],Ts=w(()=>i("div",null,null,-1)),Vs={__name:"reset",setup(v){const $=Q(),{resetSuccessData:H,resetErrorData:R,resetLoading:W}=X($),g=es(),b=Y(),A=(r,o,a)=>{o||a(new Error("This field is required"));const _=j(o);_==="Weak"?(a(new Error("Password strength: <b>Weak</b>")),e.value.password.status="Weak"):_==="Medium"?(a(),e.value.password.status="Medium",e.value.password.value="Password strength: <b>Medium</b>"):_==="Strong"&&(a(),e.value.password.status="Strong",e.value.password.value="Password strength: <b>Strong</b>")},Z=(r,o,a)=>{o===""?a(new Error("Please input the password again")):o!==n.value.password?a(new Error("Password and confirm password do not match")):a()},n=c({password:null,password_confirmation:null,pinToken:null,email:null}),h=c(!1),y=c(!1),D=c({password:[{validator:A,trigger:"input"}],password_confirmation:[{required:!0,message:"This field is required.",trigger:"blur"},{validator:Z,trigger:"blur"}]}),e=c({password:{value:"",status:null,isShow:!1},password_confirmation:{value:"",isShow:!1}});ss(()=>{for(n.value.pinToken=b.query.token,n.value.email=b.query.email;L.get("token");)L.remove("token");window.addEventListener("resize",U)});const E=r=>{g.refs[r].focus()},k=r=>{g.refs.resetForm.validateField(r,(o,a)=>{o?r!=="password"&&(e.value[r].value=""):e.value[r].value=a[r][0].message})},M=r=>{e.value[r].isShow=!0},C=r=>{u()&&(e.value[r].isShow=!0)},P=r=>{u()&&(e.value[r].isShow=!1)},U=()=>{g.update()},u=()=>window.innerWidth>990,j=r=>{const o=/^(?=.*[a-zA-Z])(?=.*[\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?])[a-zA-Z\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]{8,}$/,a=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?])[a-zA-Z\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]{12,}$/,_=/^(?:(.)(?!\1{3}))*$/,S=["password","admin","qwerty","asdfgh","xzcvb"];if(_.test(r)&&((r==null?void 0:r.length)>15||!S.some(t=>r.toLowerCase().includes(t)))){if(a.test(r)&&((r==null?void 0:r.length)>25||!S.some(t=>r.toLowerCase().includes(t))))return"Strong";if(o.test(r))return"Medium"}return"Weak"},G=()=>e.value.password.status==="Medium"?"warning":e.value.password.status==="Strong"?"done":"";T(H,r=>{r&&(n.value.password=null,n.value.password_confirmation=null,ns("/login"))}),T(R,r=>{});const J=()=>{g.refs.resetForm.validate(r=>{if(r)$.resetPassword(n._value);else return e.value.global.value="Please fill empty areas",!1})};return(r,o)=>{const a=N,_=O,S=K;return l(),d("div",us,[i("div",ps,[ms,_s,f(S,{ref:"resetForm",class:"main__form--box","hide-required-asterisk":"",model:s(n),rules:s(D),onSubmit:os(J,["prevent"])},{default:p(()=>[f(_,{prop:"password",class:"form-item"},{error:p(()=>[!s(n).password&&s(e).password.isShow&&u()?(l(),d("div",ks,[i("span",{innerHTML:s(e).password.value},null,8,xs)])):m("",!0),$s]),default:p(()=>[f(a,{ref:"password",modelValue:s(n).password,"onUpdate:modelValue":o[5]||(o[5]=t=>s(n).password=t),class:"main__form--box__input",placeholder:"Password",type:s(h)?"text":"password",onInput:o[6]||(o[6]=t=>k("password")),onBlur:o[7]||(o[7]=t=>k("password"))},{prefix:p(()=>[ws]),suffix:p(()=>[s(n).password?(l(),d("div",{key:0,style:{position:"relative"},onClick:o[0]||(o[0]=t=>E("password"))},cs)):m("",!0),i("img",{class:x(s(e).password.value?"eye_icon":""),src:s(h)?s(z):s(q),alt:"eye_icon",onClick:o[1]||(o[1]=t=>h.value=!s(h))},null,10,vs),s(e).password.value?(l(),d("div",{key:1,class:"error_icon",onMouseover:o[2]||(o[2]=t=>C("password")),onMouseout:o[3]||(o[3]=t=>P("password")),onClick:o[4]||(o[4]=t=>M("password"))},[s(e).password.status==="Medium"&&s(n).password?(l(),d("img",gs)):s(e).password.status==="Strong"&&s(n).password?(l(),d("img",hs)):(l(),d("img",ys))],32)):m("",!0),s(n).password&&s(e).password.isShow&&u()?(l(),d("div",{key:2,class:x([G(),"el-form-item__error strength"])},[i("span",{innerHTML:s(e).password.value},null,8,Ss)],2)):m("",!0)]),_:1},8,["modelValue","type"])]),_:1}),f(_,{prop:"password_confirmation",class:"form-item"},{error:p(()=>[s(e).password_confirmation.isShow&&u()?(l(),d("div",Ps,[i("span",{innerHTML:s(e).password_confirmation.value},null,8,Ls)])):m("",!0),Ts]),default:p(()=>[f(a,{ref:"password_confirmation",modelValue:s(n).password_confirmation,"onUpdate:modelValue":o[13]||(o[13]=t=>s(n).password_confirmation=t),class:"main__form--box__input",placeholder:"Confirm password",type:s(y)?"text":"password",onBlur:o[14]||(o[14]=t=>k("password_confirmation"))},{prefix:p(()=>[bs]),suffix:p(()=>[s(n).password_confirmation?(l(),d("div",{key:0,style:{position:"relative"},onClick:o[8]||(o[8]=t=>E("password_confirmation"))},Ms)):m("",!0),i("img",{class:x(s(e).password_confirmation.value?"eye_icon":""),src:s(y)?s(z):s(q),alt:"eye_icon",onClick:o[9]||(o[9]=t=>y.value=!s(y))},null,10,Cs),s(e).password_confirmation.value?(l(),d("img",{key:1,src:B,alt:"",class:"error_icon",onMouseover:o[10]||(o[10]=t=>C("password_confirmation")),onMouseout:o[11]||(o[11]=t=>P("password_confirmation")),onClick:o[12]||(o[12]=t=>M("password_confirmation"))},null,32)):m("",!0)]),_:1},8,["modelValue","type"])]),_:1}),f(ls,{"login-title":"Next","show-social":!1,"login-loading":s(W)},null,8,["login-loading"])]),_:1},8,["model","rules","onSubmit"])]),s(e).password.isShow&&!u()?(l(),V(I,{key:0,"dialog-visible":s(e).password.isShow&&!u(),"error-text":s(e).password.value,"text-color":s(e).password.status==="Medium"&&s(n).password?"warning":s(e).password.status==="Strong"&&s(n).password?"done":"weak",onVisible:o[15]||(o[15]=t=>s(e).password.isShow=!1)},null,8,["dialog-visible","error-text","text-color"])):m("",!0),s(e).password_confirmation.isShow&&!u()?(l(),V(I,{key:1,"dialog-visible":s(e).password_confirmation.isShow&&!u(),"error-text":s(e).password_confirmation.value,onVisible:o[16]||(o[16]=t=>s(e).password_confirmation.isShow=!1)},null,8,["dialog-visible","error-text"])):m("",!0)])}}},js=ds(Vs,[["__scopeId","data-v-8640c795"]]);export{js as default};
