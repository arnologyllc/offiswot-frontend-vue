import{A,D as b,G as y,a as $,r as p,e as x,E as C,h as l,i as o,F as N,q as O,u as B,m as d,c as J,f as s,o as c,t as P,v as T,x as U,z as E,y as m}from"./entry.5f1d1580.js";import{_ as V}from"./chevron-left.51363ba6.js";import F from"./settingsToken.bc7050ac.js";import L from"./loginToken.d1f0a12d.js";import W from"./auth.51b60fcb.js";import{_ as j}from"./AccessCheckModal.8f97063e.js";import{_ as q}from"./_plugin-vue_export-helper.c27b6911.js";import"./el-overlay.1dfa5af6.js";import"./el-button.d70bea62.js";import"./focus-trap.6fbf02b7.js";import"./email-primary-icon.cfc345b0.js";import"./eye-close-icon.5b83d1d5.js";const z=""+new URL("clock.e3f6f434.svg",import.meta.url).href;const _=r=>(T("data-v-4b83e2aa"),r=r(),U(),r),G={class:"main"},M={class:"main__form"},R={class:"main__form--title"},Y=_(()=>o("span",null,"Choose account to continue with",-1)),D=_(()=>o("div",{class:"main__form--subtitle"},"You can manage different accounts from one place",-1)),H={class:"main__users"},K={key:0,class:"main__top"},Q=["onClick"],X=["src"],Z={class:"main__user-actions--info"},I={class:"main__user-actions--info__email"},ee=_(()=>o("span",{class:"main__user-actions--info__time"},[o("img",{src:z,alt:"clock",class:"main__user-actions--info__clock"}),E(" Just now ")],-1)),te=_(()=>o("div",{class:"main__user-actions--add"},[o("span",null,"+"),o("span",{class:"main__user-actions--add__title"},"Create new account")],-1)),oe=[te],se={__name:"choose-account",setup(r){W();const u=A(),f=b(),g=y(),k=$(),t=p(!1),i=p(!1),h=p(null);x(()=>{i.value=L(),i.value=F(),t.value=JSON.parse(localStorage.getItem("accounts")).filter(e=>e.token)});const S=C(()=>t.value.reduce((e,a)=>(a.token&&e.push(a),e),[])),w=()=>{s.set("currentAccountID",t.value.length),s.set("addAccount",!0),window.open("/login","_blank")},v=async e=>{if(h.value=e,s.set("currentAccountID",e),t.value[e].token===s.get("token")){m("/create-workspace");return}if(u.$reset(),f.$reset(),g.$reset(),k.$reset(),(Date.parse(t.value[e].token_expires)-Date.now())/864e5<0){t.value.splice(e,1),localStorage.setItem("accounts",JSON.stringify(t.value)),t.value[0]?v(0):(Object.keys(s.get()).forEach(function(a){s.remove(a,neededAttributes)}),$router.go());return}s.set("token",t.value[e].token,{expires:(Date.parse(t.value[e].token_expires)-Date.now())/864e5}),s.set("remember_token",t.value[e].remember_token),s.set("first_login",t.value[e].first_login),t.value[e].settings_pin_token&&s.set("settings_pin_token",t.value[e].settings_pin_token),t.value[e].login_pin_token&&s.set("login_pin_token",t.value[e].login_pin_token,{expires:(Date.parse(t.value[e].login_pin_token_expires)-new Date)/864e5}),localStorage.setItem("accounts",JSON.stringify(t.value)),t.value[e].first_login===!0&&m("/pin"),u.getProfile(),await u.getWorkSpaces(),m("/create-workspace")};return(e,a)=>(c(),l("div",G,[o("div",M,[o("div",R,[o("img",{src:V,alt:"chevron-left",onClick:a[0]||(a[0]=n=>e.$router.go(-1))}),Y]),D]),o("div",H,[t.value?(c(),l("div",K,[(c(!0),l(N,null,O(B(S),n=>(c(),l("div",{key:n.ID,class:"main__user-actions",onClick:ae=>v(n.ID)},[o("img",{src:n.avatarUrl?n.avatarUrl:e.defaultAvatar,alt:"Avatar",class:"main__user-actions--avatar"},null,8,X),o("div",Z,[o("span",I,P(n.email),1),ee])],8,Q))),128))])):d("",!0),o("div",{class:"main__user-actions",onClick:w},oe)]),i.value?(c(),J(j,{key:0,"dialog-visible":i.value,onClose:a[1]||(a[1]=n=>i.value=!1)},null,8,["dialog-visible"])):d("",!0)]))}},ge=q(se,[["__scopeId","data-v-4b83e2aa"]]);export{ge as default};
