import{E as Z}from"./focus-trap.04464a06.js";import{b as T,E as ee,a as oe,_ as te}from"./error.3564d58a.js";import{E as se}from"./index.9ce43428.js";import{D as q,s as M,r,w as k,h as W,o as p,c as B,k as u,l as t,u as s,i as y,t as C,m as h,v as R,y as z,z as L,b as le,e as ae,f as ie,B as V,j as E,q as ne}from"./entry.dabfc507.js";import{_ as re}from"./email-primary-icon.1455806e.js";import{_ as U}from"./_plugin-vue_export-helper.c27b6911.js";import{h as ue,s as de}from"./eye-close-icon.eaa88d21.js";const ce=""+new URL("access-check.4d7962db.svg",import.meta.url).href,j=l=>(z("data-v-46f5211c"),l=l(),L(),l),pe=j(()=>t("div",null,[t("div",{class:"title__image"},[t("img",{src:re,alt:""})]),t("div",{class:"title__text"},"Check your email")],-1)),me=j(()=>t("span",{class:"title"},"In order to reset your PIN check your email and follow the instructions.",-1)),_e={key:0,class:"error"},fe={class:"dialog-footer"},ge={key:0},ve={key:2,class:"later"},he={__name:"OvConfirmPINChangeModal",props:{dialogVisible:{type:Boolean,required:!1},email:{type:String,default:""},appendToBody:{type:Boolean,default:!1}},setup(l){const w=l,f=q(),{changePinData:S,changePinFailureData:m}=M(f),b=r("560px"),a=r(59),n=r(null);return k(S,d=>{if(d){a.value=59;const i=setInterval(()=>{a.value&&a.value--},1e3);setTimeout(()=>{clearInterval(i)},6e4)}}),k(m,d=>{d||(n.value="You have exceeded the maximum number of reset password requests.")}),W(()=>{document.documentElement.clientWidth<=425&&(b.value="315px"),window.addEventListener("resize",i=>{i.target.innerWidth<=425?b.value="315px":b.value="560px"}),a.value=59;const d=setInterval(()=>{a.value&&a.value--},1e3);setTimeout(()=>{clearInterval(d)},6e4)}),(d,i)=>{const F=T;return p(),B(F,{modelValue:w.dialogVisible,"onUpdate:modelValue":i[1]||(i[1]=x=>w.dialogVisible=x),width:s(b),"append-to-body":l.appendToBody,"show-close":"",top:"30vh",onClose:i[2]||(i[2]=x=>d.$emit("close"))},{header:u(()=>[pe]),footer:u(()=>[t("span",fe,[s(a)&&!s(n)?(p(),y("span",ge,"0:"+C(s(a)>9?s(a):`0${s(a)}`),1)):h("",!0),!s(n)&&!s(a)?(p(),y("a",{key:1,href:"",class:"dialog-footer__action",onClick:i[0]||(i[0]=R(x=>s(f).forgotPin({email:l.email}),["prevent"]))},"Resend Email")):h("",!0),s(n)?(p(),y("span",ve," Please try again later. ")):h("",!0)])]),default:u(()=>[me,s(n)?(p(),y("span",_e,C(s(n)),1)):h("",!0)]),_:1},8,["modelValue","width","append-to-body"])}}},be=U(he,[["__scopeId","data-v-46f5211c"]]),$=l=>(z("data-v-a5b5fbe8"),l=l(),L(),l),ke=$(()=>t("div",{class:"access-header"},[t("h3",null,"Access check")],-1)),ye=$(()=>t("div",{class:"title__image"},[t("img",{src:ce,alt:""})],-1)),we=$(()=>t("span",{class:"title__text"}," Please enter your PIN in order to access account management section. ",-1)),xe={key:0,class:"el-form-item__global-error-container"},Ie={class:"el-form-item__global-error"},Ee=$(()=>t("img",{src:te,alt:""},null,-1)),$e=$(()=>t("span",{for:"pin",class:"pin_placeholder"}," Enter PIN ",-1)),Pe=[$e],Ve=["src"],Ce={class:"forgot-password"},Se={class:"submit-button__text"},Fe={__name:"AccessCheckModal",props:{dialogVisible:{type:Boolean,required:!1}},setup(l){const w=l,f=r("450px"),S=r("400px"),m=le(),b=ae(),a=ie(),n=q(),{checkPinData:d,checkPinFailureData:i,forgotPinData:F,forgotPinFailureData:x,isLoadingSubmit:D}=M(n),g=r({pin:null}),A=r({pin:[{required:!0,message:"This field is required.",trigger:"blur"},{min:4,max:6,message:"PIN must be between 4 and 6 digits",trigger:"blur"}]}),c=r({pin:{value:"",isShow:!1},global:{value:null}}),P=r(!1),I=r(!1);k(d,e=>{V.get("login_pin_token")||V.set("login_pin_token",e.login_pin_token,{expires:30}),m.emit("loginToken",V.get("login_pin_token")),V.set("settings_pin_token",e.settings_pin_token,0),m.emit("close")}),k(i,e=>{for(const o in e)if(typeof e[o]!="string")for(const v in e[o])c.value.global.value=e[o][v];else c.value.global.value=e;b.path!=="/"&&setTimeout(()=>{a.go(-1)},1e3)}),k(x,e=>{for(const o in e)if(typeof e[o]!="string")for(const v in e[o])this.errors.global.value=e[o][v];else this.errors.global.value=e[o]}),k(F,e=>{e&&(I.value=!0)}),W(()=>{document.documentElement.clientWidth<=425&&(f.value="315px"),window.addEventListener("resize",e=>{e.target.innerWidth<=425?f.value="315px":f.value="450px"})});const O=()=>{m.refs.pinForm.validate(e=>{e?n.checkPin(g._value):g._value.pin?c.value.global.value="PIN must be between 4 and 6 digits":c.value.global.value="This field is required"})},X=e=>{m.refs[e].focus()},H=()=>{I.value=!0,n.forgotPin()},Y=()=>{c.value.global.value=""},G=e=>{console.log(m.refs.pinForm),m.refs.pinForm.validateField(e,(o,v)=>{o?c.value[e].value="":c.value[e].value=v[e][0].message})};return(e,o)=>{const v=Z,J=ee,N=se,K=oe,Q=T;return p(),B(Q,{modelValue:w.dialogVisible,"onUpdate:modelValue":o[5]||(o[5]=_=>w.dialogVisible=_),width:f.value,height:S.value,"close-on-click-modal":!1,"text-align":"center","show-close":!1,top:"230px",onClose:o[6]||(o[6]=_=>e.$emit("close"))},{header:u(()=>[ke]),default:u(()=>[ye,we,E(K,{ref:"pinForm",class:"main__form--box","hide-required-asterisk":"","show-message":!1,model:g.value,rules:A.value,onSubmit:R(O,["prevent"])},{default:u(()=>[c.value.global.value?(p(),y("div",xe,[t("div",Ie,[Ee,t("span",null,C(c.value.global.value),1)]),t("span",{class:"clear-error",onClick:Y},"X")])):h("",!0),E(J,{prop:"pin",class:"password-form-item"},{default:u(()=>[E(v,{id:"pin",ref:"pin",modelValue:g.value.pin,"onUpdate:modelValue":o[2]||(o[2]=_=>g.value.pin=_),type:P.value?"text":"password",class:"main__form--box__input",placeholder:"Enter PIN",onBlur:o[3]||(o[3]=_=>G("pin"))},{suffix:u(()=>[g.value.pin?(p(),y("div",{key:0,style:{position:"relative"},onClick:o[0]||(o[0]=_=>X("pin"))},Pe)):h("",!0),t("img",{src:P.value?s(ue):s(de),alt:"eye_icon",onClick:o[1]||(o[1]=_=>P.value=!P.value)},null,8,Ve)]),_:1},8,["modelValue","type"])]),_:1}),t("div",Ce,[E(N,{style:{"font-size":"14px","font-weight":"400"},onClick:H},{default:u(()=>[ne("Forgot PIN?")]),_:1})]),E(N,{class:"submit-button","native-type":"submit",loading:s(D)},{default:u(()=>[t("span",Se,C(s(D)?"":"NEXT"),1)]),_:1},8,["loading"])]),_:1},8,["model","rules","onSubmit"]),I.value?(p(),B(be,{key:0,email:g.value.email,dialogVisible:I.value,"append-to-body":!0,onClose:o[4]||(o[4]=_=>I.value=!1)},null,8,["email","dialogVisible"])):h("",!0)]),_:1},8,["modelValue","width","height"])}}},Re=U(Fe,[["__scopeId","data-v-a5b5fbe8"]]);export{Re as C,be as a};
