import{A,B as y,E as $,a as b,r as p,e as x,C,h as l,p as o,F as N,q as B,u as O,l as v,c as J,f as s,o as c,t as P,x as T,y as U,z as E,v as m}from"./entry.44cdae02.js";import{_ as V}from"./chevron-left.aec22056.js";import F from"./settingsToken.0001c10a.js";import L from"./loginToken.1acff8c2.js";import W from"./auth.bafff1c6.js";import{_ as j}from"./AccessCheckModal.3b537c45.js";import{_ as q}from"./_plugin-vue_export-helper.c27b6911.js";import"./el-overlay.cd375e8b.js";import"./el-button.8c3cc1e7.js";import"./focus-trap.a033cdea.js";import"./email-primary-icon.6a00ece1.js";import"./eye-close-icon.e4722ace.js";const z=""+new URL("clock.e3f6f434.svg",import.meta.url).href;const _=r=>(T("data-v-587bec11"),r=r(),U(),r),M={class:"main"},R={class:"main__form"},Y={class:"main__form--title"},D=_(()=>o("span",null,"Choose account to continue with",-1)),G=_(()=>o("div",{class:"main__form--subtitle"},"You can manage different accounts from one place",-1)),H={class:"main__users"},I={key:0,class:"main__top"},K=["onClick"],Q=["src"],X={class:"main__user-actions--info"},Z={class:"main__user-actions--info__email"},ee=_(()=>o("span",{class:"main__user-actions--info__time"},[o("img",{src:z,alt:"clock",class:"main__user-actions--info__clock"}),E(" Just now ")],-1)),te=_(()=>o("div",{class:"main__user-actions--add"},[o("span",null,"+"),o("span",{class:"main__user-actions--add__title"},"Create new account")],-1)),oe=[te],se={__name:"choose-account",setup(r){W();const u=A(),f=y(),g=$(),k=b(),t=p(!1),i=p(!1),h=p(null);x(()=>{i.value=L(),i.value=F(),t.value=JSON.parse(localStorage.getItem("accounts")).filter(e=>e.token)});const S=C(()=>t.value.reduce((e,a)=>(a.token&&e.push(a),e),[])),w=()=>{s.set("currentAccountID",t.value.length),s.set("addAccount",!0),window.open("/login","_blank")},d=async e=>{if(h.value=e,s.set("currentAccountID",e),t.value[e].token===s.get("token")){m("/create-workspace");return}if(u.$reset(),f.$reset(),g.$reset(),k.$reset(),(Date.parse(t.value[e].token_expires)-Date.now())/864e5<0){t.value.splice(e,1),localStorage.setItem("accounts",JSON.stringify(t.value)),t.value[0]?d(0):(Object.keys(s.get()).forEach(function(a){s.remove(a,neededAttributes)}),$router.go());return}s.set("token",t.value[e].token,{expires:(Date.parse(t.value[e].token_expires)-Date.now())/864e5}),s.set("first_login",t.value[e].first_login),t.value[e].settings_pin_token&&s.set("settings_pin_token",t.value[e].settings_pin_token),t.value[e].login_pin_token&&s.set("login_pin_token",t.value[e].login_pin_token,{expires:(Date.parse(t.value[e].login_pin_token_expires)-new Date)/864e5}),localStorage.setItem("accounts",JSON.stringify(t.value)),t.value[e].first_login===!0&&m("/pin"),u.getProfile(),await u.getWorkSpaces(),m("/create-workspace")};return(e,a)=>(c(),l("div",M,[o("div",R,[o("div",Y,[o("img",{src:V,alt:"chevron-left",onClick:a[0]||(a[0]=n=>e.$router.go(-1))}),D]),G]),o("div",H,[t.value?(c(),l("div",I,[(c(!0),l(N,null,B(O(S),n=>(c(),l("div",{key:n.ID,class:"main__user-actions",onClick:ae=>d(n.ID)},[o("img",{src:n.avatarUrl?n.avatarUrl:e.defaultAvatar,alt:"Avatar",class:"main__user-actions--avatar"},null,8,Q),o("div",X,[o("span",Z,P(n.email),1),ee])],8,K))),128))])):v("",!0),o("div",{class:"main__user-actions",onClick:w},oe)]),i.value?(c(),J(j,{key:0,"dialog-visible":i.value,onClose:a[1]||(a[1]=n=>i.value=!1)},null,8,["dialog-visible"])):v("",!0)]))}},ge=q(se,[["__scopeId","data-v-587bec11"]]);export{ge as default};
