import{A,D as y,G as $,a as b,r as p,e as x,E as C,h as l,p as o,F as N,q as O,u as B,l as v,c as J,f as s,o as c,t as P,x as T,y as U,z as E,v as m}from"./entry.baf0f9e6.js";import{_ as V}from"./chevron-left.01779c60.js";import F from"./settingsToken.ce43d044.js";import L from"./loginToken.e88c28dc.js";import W from"./auth.128023d1.js";import{_ as j}from"./AccessCheckModal.0b76c3a7.js";import{_ as q}from"./_plugin-vue_export-helper.c27b6911.js";import"./el-overlay.92e06c40.js";import"./el-button.667d5ca7.js";import"./focus-trap.cc6ee356.js";import"./email-primary-icon.a6e361b0.js";import"./eye-close-icon.68231b65.js";const z=""+new URL("clock.e3f6f434.svg",import.meta.url).href;const _=r=>(T("data-v-3c5e417b"),r=r(),U(),r),D={class:"main"},G={class:"main__form"},M={class:"main__form--title"},R=_(()=>o("span",null,"Choose account to continue with",-1)),Y=_(()=>o("div",{class:"main__form--subtitle"},"You can manage different accounts from one place",-1)),H={class:"main__users"},I={key:0,class:"main__top"},K=["onClick"],Q=["src"],X={class:"main__user-actions--info"},Z={class:"main__user-actions--info__email"},ee=_(()=>o("span",{class:"main__user-actions--info__time"},[o("img",{src:z,alt:"clock",class:"main__user-actions--info__clock"}),E(" Just now ")],-1)),te=_(()=>o("div",{class:"main__user-actions--add"},[o("span",null,"+"),o("span",{class:"main__user-actions--add__title"},"Create new account")],-1)),oe=[te],se={__name:"choose-account",setup(r){W();const u=A(),f=y(),g=$(),k=b(),t=p(!1),i=p(!1),h=p(null);x(()=>{i.value=L(),i.value=F(),t.value=JSON.parse(localStorage.getItem("accounts")).filter(e=>e.token)});const S=C(()=>t.value.reduce((e,a)=>(a.token&&e.push(a),e),[])),w=()=>{s.set("currentAccountID",t.value.length),s.set("addAccount",!0),window.open("/login","_blank")},d=async e=>{if(h.value=e,s.set("currentAccountID",e),t.value[e].token===s.get("token")){m("/create-workspace");return}if(u.$reset(),f.$reset(),g.$reset(),k.$reset(),(Date.parse(t.value[e].token_expires)-Date.now())/864e5<0){t.value.splice(e,1),localStorage.setItem("accounts",JSON.stringify(t.value)),t.value[0]?d(0):(Object.keys(s.get()).forEach(function(a){s.remove(a,neededAttributes)}),$router.go());return}s.set("token",t.value[e].token,{expires:(Date.parse(t.value[e].token_expires)-Date.now())/864e5}),s.set("first_login",t.value[e].first_login),t.value[e].settings_pin_token&&s.set("settings_pin_token",t.value[e].settings_pin_token),t.value[e].login_pin_token&&s.set("login_pin_token",t.value[e].login_pin_token,{expires:(Date.parse(t.value[e].login_pin_token_expires)-new Date)/864e5}),localStorage.setItem("accounts",JSON.stringify(t.value)),t.value[e].first_login===!0&&m("/pin"),u.getProfile(),await u.getWorkSpaces(),m("/create-workspace")};return(e,a)=>(c(),l("div",D,[o("div",G,[o("div",M,[o("img",{src:V,alt:"chevron-left",onClick:a[0]||(a[0]=n=>e.$router.go(-1))}),R]),Y]),o("div",H,[t.value?(c(),l("div",I,[(c(!0),l(N,null,O(B(S),n=>(c(),l("div",{key:n.ID,class:"main__user-actions",onClick:ae=>d(n.ID)},[o("img",{src:n.avatarUrl?n.avatarUrl:e.defaultAvatar,alt:"Avatar",class:"main__user-actions--avatar"},null,8,Q),o("div",X,[o("span",Z,P(n.email),1),ee])],8,K))),128))])):v("",!0),o("div",{class:"main__user-actions",onClick:w},oe)]),i.value?(c(),J(j,{key:0,"dialog-visible":i.value,onClose:a[1]||(a[1]=n=>i.value=!1)},null,8,["dialog-visible"])):v("",!0)]))}},ge=q(se,[["__scopeId","data-v-3c5e417b"]]);export{ge as default};
