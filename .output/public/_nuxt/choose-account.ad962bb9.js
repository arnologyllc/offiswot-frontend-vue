import{b as S,r as p,e as A,f as I,E as x,i as _,j as s,u as g,F as y,v as D,p as k,c as b,h as o,o as r,t as C,x as N,y as $,A as O,z as m}from"./entry.c6755e4d.js";import{_ as B}from"./chevron-left.56fb7d2b.js";import J from"./settingsToken.5cec770a.js";import T from"./loginToken.dd8ca5fd.js";import U from"./auth.e87f786b.js";import{_ as E}from"./AccessCheckModal.ba22c7a9.js";import{_ as P}from"./_plugin-vue_export-helper.c27b6911.js";import"./el-overlay.4b93bec8.js";import"./el-button.fb5dead5.js";import"./focus-trap.496d67e9.js";import"./email-primary-icon.6c8640f5.js";import"./eye-close-icon.3601fe2b.js";const V=""+new URL("clock.e3f6f434.svg",import.meta.url).href;const u=l=>(N("data-v-85c56f96"),l=l(),$(),l),j={class:"main"},F={class:"main__form"},L={class:"main__form--title"},R=u(()=>s("span",null,"Choose account to continue with",-1)),z=u(()=>s("div",{class:"main__form--subtitle"},"You can manage different accounts from one place",-1)),M={class:"main__users"},W={key:0,class:"main__top"},Y=["onClick"],q=["src"],G={class:"main__user-actions--info"},H={class:"main__user-actions--info__email"},K=u(()=>s("span",{class:"main__user-actions--info__time"},[s("img",{src:V,alt:"clock",class:"main__user-actions--info__clock"}),O(" Just now ")],-1)),Q=u(()=>s("div",{class:"main__user-actions--add"},[s("span",null,"+"),s("span",{class:"main__user-actions--add__title"},"Add new account")],-1)),X=[Q],Z={__name:"choose-account",setup(l){U();const v=S(),e=p(!1),c=p(!1),t=p(null),d=A();I(()=>{c.value=T(),c.value=J(),e.value=JSON.parse(localStorage.getItem("accounts")).filter(n=>n.token)});const h=x(()=>e.value.reduce((n,a)=>(a.token&&n.push(a),n),[])),w=()=>{o.set("addAccount",!0),window.open("/login","_blank")},f=async n=>{if(t.value=e.value.findIndex(a=>a.email===n),o.set("currentAccountID",t.value),e.value[t.value].token===o.get("token")){m("/create-workspace");return}if(v.$reset(),(Date.parse(e.value[t.value].token_expires)-Date.now())/864e5<0){e.value.splice(t.value,1),localStorage.setItem("accounts",JSON.stringify(e.value)),e.value[0]?f(0):(Object.keys(o.get()).forEach(function(a){o.remove(a,neededAttributes)}),d.go());return}o.set("token",e.value[t.value].token,{expires:(Date.parse(e.value[t.value].token_expires)-Date.now())/864e5}),o.set("remember_token",e.value[t.value].remember_token),o.set("first_login",e.value[t.value].first_login),e.value[t.value].settings_pin_token?o.set("settings_pin_token",e.value[t.value].settings_pin_token):o.remove("settings_pin_token"),e.value[t.value].login_pin_token?o.set("login_pin_token",e.value[t.value].login_pin_token,{expires:(Date.parse(e.value[t.value].login_pin_token_expires)-new Date)/864e5}):o.remove("login_pin_token"),localStorage.setItem("accounts",JSON.stringify(e.value)),e.value[t.value].first_login===!0&&m("/pin"),v.getProfile(),await v.getWorkSpaces(),m("/create-workspace")};return(n,a)=>(r(),_("div",j,[s("div",F,[s("div",L,[s("img",{src:B,alt:"chevron-left",onClick:a[0]||(a[0]=i=>g(d).go(-1))}),R]),z]),s("div",M,[e.value?(r(),_("div",W,[(r(!0),_(y,null,D(g(h),i=>(r(),_("div",{key:i.ID,class:"main__user-actions",onClick:ee=>f(i.email)},[s("img",{src:i.avatarUrl?i.avatarUrl:n.defaultAvatar,alt:"Avatar",class:"main__user-actions--avatar"},null,8,q),s("div",G,[s("span",H,C(i.email),1),K])],8,Y))),128))])):k("",!0),s("div",{class:"main__user-actions",onClick:w},X)]),c.value?(r(),b(E,{key:0,"dialog-visible":c.value,onClose:a[1]||(a[1]=i=>c.value=!1)},null,8,["dialog-visible"])):k("",!0)]))}},pe=P(Z,[["__scopeId","data-v-85c56f96"]]);export{pe as default};
