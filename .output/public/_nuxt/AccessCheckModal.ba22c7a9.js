import{c as M,_ as Y,a as G,b as K,E as Q}from"./el-overlay.4b93bec8.js";import{E as Z}from"./el-button.fb5dead5.js";import{D as R,s as F,r,w as y,f as L,o as m,c as B,l as u,j as o,u as s,i as w,t as S,p as f,b as ee,H as te,e as oe,k as P,A as se,m as le,h as g,q as ae}from"./entry.c6755e4d.js";import{_ as ne}from"./email-primary-icon.6c8640f5.js";import{h as ie,s as re}from"./eye-close-icon.3601fe2b.js";const ue=""+new URL("access-check.4d7962db.svg",import.meta.url).href,ce=o("div",null,[o("div",{class:"title__image"},[o("img",{src:ne,alt:""})]),o("div",{class:"title__text"},"Check your email")],-1),de=o("span",{class:"title"},"In order to reset your PIN check your email and follow the instructions.",-1),pe={key:0,class:"error"},me={class:"dialog-footer"},_e={key:0},ge={key:2,class:"later"},fe={__name:"OvConfirmPINChangeModal",props:{dialogVisible:{type:Boolean,required:!1},email:{type:String,default:""},appendToBody:{type:Boolean,default:!1}},setup(I){const v=I,E=R(),{forgotPinData:h,forgotPinFailureData:N}=F(E),a=r("560px"),n=r(59),c=r(null);y(h,_=>{});const x=()=>{n._value=59,E.forgotPin({email:v.email})};return y(N,_=>{_&&(c.value="You have exceeded the maximum number of reset PIN requests.")}),L(()=>{document.documentElement.clientWidth<=425&&(a.value="315px"),window.addEventListener("resize",_=>{_.target.innerWidth<=425?a.value="315px":a.value="560px"}),setInterval(()=>{n.value&&n.value--},1e3)}),(_,b)=>{const C=M;return m(),B(C,{modelValue:v.dialogVisible,"onUpdate:modelValue":b[0]||(b[0]=$=>v.dialogVisible=$),width:s(a),"append-to-body":I.appendToBody,"show-close":"",top:"30vh",class:"customModal",onClose:b[1]||(b[1]=$=>_.$emit("close"))},{header:u(()=>[ce]),footer:u(()=>[o("span",me,[s(n)&&!s(c)?(m(),w("span",_e,"0:"+S(s(n)>9?s(n):`0${s(n)}`),1)):f("",!0),!s(c)&&!s(n)?(m(),w("a",{key:1,href:"",class:"dialog-footer__action",onClick:x},"Resend Email")):f("",!0),s(c)?(m(),w("span",ge," Please try again later. ")):f("",!0)])]),default:u(()=>[de,s(c)?(m(),w("span",pe,S(s(c)),1)):f("",!0)]),_:1},8,["modelValue","width","append-to-body"])}}},ve=o("div",{class:"access-header"},[o("h3",null,"Access check")],-1),he=o("div",{class:"title__image"},[o("img",{src:ue,alt:""})],-1),be=o("span",{class:"title__text"}," Please enter your PIN in order to access account management section. ",-1),ke={key:0,class:"el-form-item__global-error-container"},ye={class:"el-form-item__global-error"},we=o("img",{src:Y,alt:""},null,-1),xe=o("span",{for:"pin",class:"custom_placeholder"}," Enter PIN ",-1),Pe=[xe],Ie=["src"],Ee={class:"forgot-password"},$e={class:"submit-button__text"},Fe={__name:"AccessCheckModal",props:{dialogVisible:{type:Boolean,required:!1}},setup(I){const v=I,E=ee(),h=r("450px"),N=r("400px"),a=ae(),n=te(),c=oe(),x=R(),{checkPinData:_,checkPinFailureData:b,forgotPinData:C,forgotPinFailureData:$,isLoadingSubmit:T}=F(x),{profileSuccessData:q}=F(E),d=r({pin:null}),O=r({pin:[{required:!0,message:"This field is required.",trigger:"blur"},{min:4,max:6,message:"PIN must be between 4 and 6 digits",trigger:"blur"}]}),i=r({pin:{value:"",isShow:!1},global:{value:null}}),V=r(!1),D=r(!1);y(_,({data:t})=>{const e=g.get("currentAccountID")?g.get("currentAccountID"):0;{const l=JSON.parse(localStorage.getItem("accounts"));if(!g.get("login_pin_token")&&g.get("login_pin_token")!==t.login_pin_token){const k=new Date;k.setDate(k.getDate()+30),g.set("login_pin_token",t.login_pin_token,{expires:(Date.parse(k)-new Date)/864e5}),l[e].login_pin_token=t.login_pin_token,l[e].login_pin_token_expires=k}a.emit("loginToken",g.get("login_pin_token")),g.set("settings_pin_token",t.settings_pin_token,0),l[e].settings_pin_token=t.settings_pin_token,localStorage.setItem("accounts",JSON.stringify(l))}a.emit("close"),c.go()}),y(b,t=>{if(typeof t!="string")for(const e in t)if(typeof t[e]!="string")for(const l in t[e])i.value.global.value=t[e][l];else i.value.global.value=t[e];else i.value.global.value=t;n.path!=="/"&&setTimeout(()=>{c.go(-1)},1e3)}),y($,t=>{for(const e in t)if(typeof t[e]!="string")for(const l in t[e])this.errors.global.value=t[e][l];else this.errors.global.value=t[e]}),y(C,t=>{t&&(D.value=!0)}),L(()=>{var t,e;(t=q.value)!=null&&t.user.email&&(d.value.email=(e=q.value)==null?void 0:e.user.email),document.documentElement.clientWidth<=425&&(h.value="315px"),window.addEventListener("resize",l=>{l.target.innerWidth<=425?h.value="315px":h.value="450px"})});const U=()=>{a.refs.pinForm.validate(t=>{t?x.checkPin(d.value):d.value.pin?i.value.global.value="PIN must be between 4 and 6 digits":i.value.global.value="This field is required"})},j=t=>{a.refs[t].focus()},z=()=>{x.forgotPin()},H=()=>{i.value.global.value=""},A=t=>{a.refs.pinForm.validateField(t,(e,l)=>{e?i.value.global.value="":i.value.global.value=l[t][0].message})};return(t,e)=>{const l=G,k=K,W=Z,J=Q,X=M;return m(),B(X,{modelValue:v.dialogVisible,"onUpdate:modelValue":e[6]||(e[6]=p=>v.dialogVisible=p),width:h.value,height:N.value,"close-on-click-modal":!1,"text-align":"center","show-close":!1,top:"230px",class:"access_modal",onClose:e[7]||(e[7]=p=>t.$emit("close"))},{header:u(()=>[ve]),default:u(()=>[he,be,P(J,{ref:"pinForm",class:"main__form--box","hide-required-asterisk":"","show-message":!1,model:d.value,rules:O.value,onSubmit:le(U,["prevent"])},{default:u(()=>[i.value.global.value?(m(),w("div",ke,[o("div",ye,[we,o("span",null,S(i.value.global.value),1)]),o("span",{class:"clear-error",onClick:H},"X")])):f("",!0),P(k,{prop:"pin",class:"password-form-item"},{default:u(()=>[P(l,{id:"pin",ref:"pin",modelValue:d.value.pin,"onUpdate:modelValue":e[2]||(e[2]=p=>d.value.pin=p),type:V.value?"text":"password",class:"main__form--box__input",placeholder:"Enter PIN",autofocus:"",onInput:e[3]||(e[3]=p=>A("pin")),onBlur:e[4]||(e[4]=p=>A("pin"))},{suffix:u(()=>[d.value.pin?(m(),w("div",{key:0,style:{position:"relative"},onClick:e[0]||(e[0]=p=>j("pin"))},Pe)):f("",!0),o("img",{src:V.value?s(ie):s(re),alt:"eye_icon",onClick:e[1]||(e[1]=p=>V.value=!V.value)},null,8,Ie)]),_:1},8,["modelValue","type"])]),_:1}),o("div",Ee,[P(W,{style:{"font-size":"14px","font-weight":"400"},onClick:z},{default:u(()=>[se("Forgot PIN?")]),_:1})]),P(W,{class:"submit-button","native-type":"submit",loading:s(T),disabled:!d.value.pin},{default:u(()=>[o("span",$e,S(s(T)?"":"NEXT"),1)]),_:1},8,["loading","disabled"])]),_:1},8,["model","rules","onSubmit"]),D.value?(m(),B(fe,{key:0,email:d.value.email,"dialog-visible":D.value,"append-to-body":!0,onClose:e[5]||(e[5]=p=>D.value=!1)},null,8,["email","dialog-visible"])):f("",!0)]),_:1},8,["modelValue","width","height"])}}};export{Fe as _,fe as a};
