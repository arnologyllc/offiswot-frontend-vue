import{E as G}from"./el-input.7fd03793.js";import{E as N,_ as C,a as O}from"./el-overlay.64de5399.js";import{E as X}from"./el-checkbox.a01c856e.js";import{E as J}from"./el-button.6d07ff3a.js";import"./el-form-item.4ed993c7.js";import{z as K,s as Q,r as w,w as B,e as Y,f as _,m as r,h as c,i as n,u as s,j as Z,c as I,k as d,l as ee,o as u,t as q,A as oe,v as V,q as se,x as le,y as te}from"./entry.1c65c56b.js";import{_ as re,a as ie}from"./OvConfirmEmailModal.662adde1.js";import{_ as ae}from"./lock-icon.b44fcfe9.js";import{a as f}from"./js.cookie.edb2da2a.js";import{n as E}from"./nuxt-storage.min.d80392db.js";import{L as ne}from"./LoginButtons.107bf4a0.js";import{E as A}from"./ErrorMassageModal.180b4dfd.js";import{h as ue,s as me}from"./eye-close-icon.f5ebd9e6.js";import{_ as de}from"./_plugin-vue_export-helper.c27b6911.js";import"./focus-trap.cf142168.js";import"./refs.6073550b.js";import"./isEqual.90c5f9f6.js";import"./flatten.0b3b173a.js";import"./email-primary-icon.754ea29f.js";import"./_commonjsHelpers.042e6b4d.js";import"./chevron-icon.1bc5d74d.js";const m=b=>(le("data-v-1791e01d"),b=b(),te(),b),pe={class:"main"},_e={class:"main__form"},ce=m(()=>r("div",{class:"main__form--title"},"Log In",-1)),fe=m(()=>r("div",{class:"main__form--subtitle"},"Please fill the forms to log in",-1)),ve={key:0,class:"el-form-item__global-error-container"},ge={class:"el-form-item__global-error"},we=m(()=>r("img",{src:C,alt:""},null,-1)),ke=m(()=>r("img",{src:ie,alt:"user_icon"},null,-1)),be=m(()=>r("span",{for:"email",class:"custom_placeholder"}," Email or username ",-1)),ye=[be],he=m(()=>r("div",null,null,-1)),xe={key:0,class:"el-form-item__error"},Se=m(()=>r("div",null,null,-1)),Ee=m(()=>r("img",{src:ae,alt:"password_icon"},null,-1)),De=m(()=>r("span",{for:"password",class:"custom_placeholder"}," Password ",-1)),$e=[De],Ie=["src"],Ve={key:0,class:"el-form-item__error"},Ce=["innerHTML"],Te=m(()=>r("div",null,null,-1)),Fe={class:"forgot-password"},Le=m(()=>r("span",{style:{"font-weight":"400"}},"Remember me",-1)),Me={__name:"login",setup(b){const D=K(),{loginSuccessData:U,loginErrorData:z}=Q(D),y=ee(),h=w(!1),x=w(!1),v=w({ID:null,email:null,avatarUrl:null,token:null,token_expires:null,first_login:null,settings_pin_token:null,login_pin_token:null,login_pin_token_expires:null}),i=w({email:null,password:null,remember_me:!1}),l=w({email:{value:"",isShow:!1},password:{value:"",isShow:!1},global:{value:""}}),H=w({email:[{required:!0,message:"This field is required.",trigger:"blur"}],password:[{required:!0,message:"This field is required.",trigger:"blur"}]});B(U,o=>{f.remove("token"),f.remove("first_login"),f.remove("settings_pin_token"),f.remove("login_pin_token"),f.remove("addAccount");const e=E.localStorage.getData("accounts")?E.localStorage.getData("accounts"):[],[a,g]=[o.access_token,o.is_first_login],S=i.value.remember_me?null:1/24,k=new Date;k.setHours(k.getHours()+1),S?v.value.token_expires=k:v.value.token_expires=null,f.set("token",a,{expires:S}),v.value.email=o.user.email,v.value.token=a,v.value.first_login=g,e.unshift(v.value),e.forEach(($,t)=>$.ID=t),E.localStorage.setData("accounts",e,30,"d"),f.set("currentAccountID",0),g?(V("/pin"),f.set("first_login",g)):V("/")}),B(z,o=>{if((o==="Please visit your email to verify your account."||(o==null?void 0:o.error)==="Please visit your email to verify your account.")&&(x.value=!0),o==="Incorrect username or password."&&(l.value.global.value=o),typeof o!="string")for(const e in o)if(typeof o[e]!="string")for(const a in o[e])l.value.global.value=o[e][a];else l.value.global.value=o[e]}),Y(()=>{const o=new Date;o.setDate(o.getDate()+30),window.addEventListener("resize",j)});const R=()=>{y.refs.loginForm.validate(o=>{var e;if(o)(e=E.localStorage.getData("accounts"))!=null&&e.some(a=>a.email===i.value.email)?l.value.global.value="Account already logined":D.loginUser(i.value);else return l.value.global.value="Please fill empty areas",!1})},T=o=>{y.refs[o].focus()},F=o=>{y.refs.loginForm.validateField(o,(e,a)=>{e?l.value[o].value="":l.value[o].value=a[o][0].message})},L=o=>{l.value[o].isShow=!0},M=o=>{p()&&(l.value[o].isShow=!0)},P=o=>{p()&&(l.value[o].isShow=!1)},j=()=>{y.update()},p=()=>window.innerWidth>990,W=()=>{l.value.global.value=""};return(o,e)=>{const a=G,g=O,S=X,k=J,$=N;return u(),_("div",pe,[r("div",_e,[ce,fe,c($,{ref:"loginForm",class:"main__form--box","hide-required-asterisk":"",model:s(i),rules:s(H),onSubmit:Z(R,["prevent"])},{default:n(()=>[s(l).global.value?(u(),_("div",ve,[r("div",ge,[we,r("span",null,q(s(l).global.value),1)]),r("span",{class:"clear-error",onClick:W},"X")])):d("",!0),c(g,{prop:"email"},{error:n(()=>[s(l).email.isShow&&p()?(u(),_("div",xe,[r("span",null,q(s(l).email.value),1)])):d("",!0),Se]),default:n(()=>[c(a,{ref:"email",modelValue:s(i).email,"onUpdate:modelValue":e[4]||(e[4]=t=>s(i).email=t),class:"main__form--box__input",placeholder:"Email or username",onBlur:e[5]||(e[5]=t=>F("email"))},{prefix:n(()=>[ke]),suffix:n(()=>[s(l).email.value?(u(),_("img",{key:0,class:"error_icon",src:C,alt:"",onMouseover:e[0]||(e[0]=t=>M("email")),onMouseout:e[1]||(e[1]=t=>P("email")),onClick:e[2]||(e[2]=t=>L("email"))},null,32)):d("",!0),s(i).email?(u(),_("div",{key:1,style:{position:"relative"},onClick:e[3]||(e[3]=t=>T("email"))},ye)):d("",!0),he]),_:1},8,["modelValue"])]),_:1}),c(g,{prop:"password",class:"password-form-item"},{error:n(()=>[s(l).password.isShow&&p()?(u(),_("div",Ve,[r("span",{innerHTML:s(l).password.value},null,8,Ce)])):d("",!0),Te]),default:n(()=>[c(a,{id:"password",ref:"password",modelValue:s(i).password,"onUpdate:modelValue":e[11]||(e[11]=t=>s(i).password=t),type:s(h)?"text":"password",class:"main__form--box__input",placeholder:"Password",onBlur:e[12]||(e[12]=t=>F("password"))},{prefix:n(()=>[Ee]),suffix:n(()=>[s(i).password?(u(),_("div",{key:0,style:{position:"relative"},onClick:e[6]||(e[6]=t=>T("password"))},$e)):d("",!0),r("img",{class:oe(s(l).password.value?"eye_icon":""),src:s(h)?s(ue):s(me),alt:"eye_icon",onClick:e[7]||(e[7]=t=>h.value=!s(h))},null,10,Ie),s(l).password.value?(u(),_("img",{key:1,src:C,alt:"",class:"error_icon",onMouseover:e[8]||(e[8]=t=>M("password")),onMouseout:e[9]||(e[9]=t=>P("password")),onClick:e[10]||(e[10]=t=>L("password"))},null,32)):d("",!0)]),_:1},8,["modelValue","type"]),r("div",Fe,[c(S,{modelValue:s(i).remember_me,"onUpdate:modelValue":e[13]||(e[13]=t=>s(i).remember_me=t),class:"remember-checkbox"},{default:n(()=>[Le]),_:1},8,["modelValue"]),c(k,{text:"",onClick:e[14]||(e[14]=t=>("navigateTo"in o?o.navigateTo:s(V))("/password/forgot"))},{default:n(()=>[se("Forgot Password?")]),_:1})])]),_:1}),c(ne,{"login-loading":s(D).loginLoading,"login-title":"Log In","social-title":"Sign in with Google"},null,8,["login-loading"])]),_:1},8,["model","rules","onSubmit"])]),s(x)?(u(),I(re,{key:0,email:s(i).email,"dialog-visible":s(x),onClose:e[15]||(e[15]=t=>x.value=!1)},null,8,["email","dialog-visible"])):d("",!0),s(l).email.isShow&&!p()?(u(),I(A,{key:1,"dialog-visible":s(l).email.isShow&&!p(),"error-text":s(l).email.value,onVisible:e[16]||(e[16]=t=>s(l).email.isShow=!1)},null,8,["dialog-visible","error-text"])):d("",!0),s(l).password.isShow&&!p()?(u(),I(A,{key:2,"dialog-visible":s(l).password.isShow&&!p(),"error-text":s(l).password.value,onVisible:e[17]||(e[17]=t=>s(l).password.isShow=!1)},null,8,["dialog-visible","error-text"])):d("",!0)])}}},so=de(Me,[["__scopeId","data-v-1791e01d"]]);export{so as default};
