import{E as K}from"./focus-trap.04464a06.js";import{_ as B,E as N,a as O}from"./error.3564d58a.js";import{A as Q,s as X,b as Y,e as ss,r as c,h as os,B as V,w as L,o as l,i as d,l as i,j as f,k as p,u as s,m,C as k,v as es,c as T,x as rs,y as ts,z as as}from"./entry.dabfc507.js";import{_ as F}from"./lock-icon.3790485a.js";import{_ as ns,a as is}from"./good.9906b833.js";import{L as ls}from"./LoginButtons.a98def6d.js";import{E as I}from"./ErrorMassageModal.8c97b422.js";import{h as z,s as q}from"./eye-close-icon.eaa88d21.js";import{_ as ds}from"./_plugin-vue_export-helper.c27b6911.js";import"./index.9ce43428.js";import"./chevron-icon.ef3f9a72.js";const w=v=>(ts("data-v-9c1dc3db"),v=v(),as(),v),us={class:"main"},ps={class:"main__form"},ms=w(()=>i("div",{class:"main__form--title"},"Reset password",-1)),_s=w(()=>i("div",{class:"main__form--subtitle"}," Please fill the forms to reset password ",-1)),ws=w(()=>i("img",{src:F,alt:"password_icon"},null,-1)),fs=w(()=>i("span",{for:"password",class:"placeholder placeholder__password"}," Password ",-1)),cs=[fs],vs=["src"],gs={key:0,src:ns,alt:""},hs={key:1,src:is,alt:""},ys={key:2,src:B,alt:""},Ss=["innerHTML"],ks={key:0,class:"el-form-item__error"},xs=["innerHTML"],bs=w(()=>i("div",null,null,-1)),$s=w(()=>i("img",{src:F,alt:"password_icon"},null,-1)),Es=w(()=>i("span",{for:"password_confirmation",class:"placeholder placeholder__passwordConfirmation"}," Confirm Password ",-1)),Ms=[Es],Cs=["src"],Ps={key:0,class:"el-form-item__error"},Vs=["innerHTML"],Ls=w(()=>i("div",null,null,-1)),Ts={__name:"reset",setup(v){const x=Q(),{resetSuccessData:R,resetErrorData:A,resetLoading:H}=X(x),g=Y(),b=ss(),W=(r,o,n)=>{o||n(new Error("This field is required"));const _=j(o);_==="Weak"?(n(new Error("Password strength: <b>Weak</b>")),e.value.password.status="Weak"):_==="Medium"?(n(),e.value.password.status="Medium",e.value.password.value="Password strength: <b>Medium</b>"):_==="Strong"&&(n(),e.value.password.status="Strong",e.value.password.value="Password strength: <b>Strong</b>")},Z=(r,o,n)=>{o===""?n(new Error("Please input the password again")):o!==a.value.password?n(new Error("Password and confirm password do not match")):n()},a=c({password:null,password_confirmation:null,pinToken:null,email:null}),h=c(!1),y=c(!1),D=c({password:[{validator:W,trigger:"input"}],password_confirmation:[{required:!0,message:"This field is required.",trigger:"blur"},{validator:Z,trigger:"blur"}]}),e=c({password:{value:"",status:null,isShow:!1},password_confirmation:{value:"",isShow:!1}});os(()=>{for(a.value.pinToken=b.query.token,a.value.email=b.query.email;V.get("token");)V.remove("token");window.addEventListener("resize",U)});const $=r=>{g.refs[r].focus()},E=r=>{g.refs.resetForm.validateField(r,(o,n)=>{o?r!=="password"&&(e.value[r].value=""):e.value[r].value=n[r][0].message})},M=r=>{e.value[r].isShow=!0},C=r=>{u()&&(e.value[r].isShow=!0)},P=r=>{u()&&(e.value[r].isShow=!1)},U=()=>{g.update()},u=()=>window.innerWidth>990,j=r=>{const o=/^(?=.*[a-zA-Z])(?=.*[\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?])[a-zA-Z\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]{8,}$/,n=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?])[a-zA-Z\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]{12,}$/,_=/^(?:(.)(?!\1{3}))*$/,S=["password","admin","qwerty","asdfgh","xzcvb"];if(_.test(r)&&((r==null?void 0:r.length)>15||!S.some(t=>r.toLowerCase().includes(t)))){if(n.test(r)&&((r==null?void 0:r.length)>25||!S.some(t=>r.toLowerCase().includes(t))))return"Strong";if(o.test(r))return"Medium"}return"Weak"},G=()=>e.value.password.status==="Medium"?"warning":e.value.password.status==="Strong"?"done":"";L(R,r=>{r&&(a.value.password=null,a.value.password_confirmation=null,rs("/login"))}),L(A,r=>{});const J=()=>{g.refs.resetForm.validate(r=>{if(r)x.resetPassword(a._value);else return e.value.global.value="Please fill empty areas",!1})};return(r,o)=>{const n=K,_=N,S=O;return l(),d("div",us,[i("div",ps,[ms,_s,f(S,{ref:"resetForm",class:"main__form--box","hide-required-asterisk":"",model:s(a),rules:s(D),onSubmit:es(J,["prevent"])},{default:p(()=>[f(_,{prop:"password",class:"form-item"},{error:p(()=>[s(e).password.isShow&&u()?(l(),d("div",ks,[i("span",{innerHTML:s(e).password.value},null,8,xs)])):m("",!0),bs]),default:p(()=>[f(n,{ref:"password",modelValue:s(a).password,"onUpdate:modelValue":o[5]||(o[5]=t=>s(a).password=t),class:"main__form--box__input",placeholder:"Password",type:s(h)?"text":"password",onInput:o[6]||(o[6]=t=>E("password"))},{prefix:p(()=>[ws]),suffix:p(()=>[s(a).password?(l(),d("div",{key:0,style:{position:"relative"},onClick:o[0]||(o[0]=t=>$("password"))},cs)):m("",!0),i("img",{class:k(s(e).password.value?"eye_icon":""),src:s(h)?s(z):s(q),alt:"eye_icon",onClick:o[1]||(o[1]=t=>h.value=!s(h))},null,10,vs),s(e).password.value?(l(),d("div",{key:1,class:"error_icon",onMouseover:o[2]||(o[2]=t=>C("password")),onMouseout:o[3]||(o[3]=t=>P("password")),onClick:o[4]||(o[4]=t=>M("password"))},[s(e).password.status==="Medium"&&s(a).password?(l(),d("img",gs)):s(e).password.status==="Strong"&&s(a).password?(l(),d("img",hs)):(l(),d("img",ys))],32)):m("",!0),s(a).password&&s(e).password.isShow&&u()?(l(),d("div",{key:2,class:k([G(),"el-form-item__error strength"])},[i("span",{innerHTML:s(e).password.value},null,8,Ss)],2)):m("",!0)]),_:1},8,["modelValue","type"])]),_:1}),f(_,{prop:"password_confirmation",class:"form-item"},{error:p(()=>[s(e).password_confirmation.isShow&&u()?(l(),d("div",Ps,[i("span",{innerHTML:s(e).password_confirmation.value},null,8,Vs)])):m("",!0),Ls]),default:p(()=>[f(n,{ref:"password_confirmation",modelValue:s(a).password_confirmation,"onUpdate:modelValue":o[12]||(o[12]=t=>s(a).password_confirmation=t),class:"main__form--box__input",placeholder:"Confirm password",type:s(y)?"text":"password",onBlur:o[13]||(o[13]=t=>E("password_confirmation"))},{prefix:p(()=>[$s]),suffix:p(()=>[s(a).password_confirmation?(l(),d("div",{key:0,style:{position:"relative"},onClick:o[7]||(o[7]=t=>$("password_confirmation"))},Ms)):m("",!0),i("img",{class:k(s(e).password_confirmation.value?"eye_icon":""),src:s(y)?s(z):s(q),alt:"eye_icon",onClick:o[8]||(o[8]=t=>y.value=!s(y))},null,10,Cs),s(e).password_confirmation.value?(l(),d("img",{key:1,src:B,alt:"",class:"error_icon",onMouseover:o[9]||(o[9]=t=>C("password_confirmation")),onMouseout:o[10]||(o[10]=t=>P("password_confirmation")),onClick:o[11]||(o[11]=t=>M("password_confirmation"))},null,32)):m("",!0)]),_:1},8,["modelValue","type"])]),_:1}),f(ls,{"login-title":"Next","show-social":!1,"login-loading":s(H)},null,8,["login-loading"])]),_:1},8,["model","rules","onSubmit"])]),s(e).password.isShow&&!u()?(l(),T(I,{key:0,dialogVisible:s(e).password.isShow&&!u(),"error-text":s(e).password.value,"text-color":s(e).password.status==="Medium"&&s(a).password?"warning":s(e).password.status==="Strong"&&s(a).password?"done":"weak",onVisible:o[14]||(o[14]=t=>s(e).password.isShow=!1)},null,8,["dialogVisible","error-text","text-color"])):m("",!0),s(e).password_confirmation.isShow&&!u()?(l(),T(I,{key:1,dialogVisible:s(e).password_confirmation.isShow&&!u(),"error-text":s(e).password_confirmation.value,onVisible:o[15]||(o[15]=t=>s(e).password_confirmation.isShow=!1)},null,8,["dialogVisible","error-text"])):m("",!0)])}}},Us=ds(Ts,[["__scopeId","data-v-9c1dc3db"]]);export{Us as default};
