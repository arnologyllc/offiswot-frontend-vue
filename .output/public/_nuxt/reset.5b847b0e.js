import{E as W,_ as S,a as G,b as O}from"./el-overlay.6ca4e62b.js";import{E as J}from"./el-button.e243c5d4.js";import"./el-form-item.4ed993c7.js";import{B as K,s as Q,H as X,r as f,w as N,e as Y,h as p,p as s,i as v,j as m,u as o,k as Z,m as ee,o as a,t as C,l as u,G as V,c as M,x as oe,y as ie,v as ne}from"./entry.a509592d.js";import{E as T}from"./ErrorMassageModal.1c89c491.js";import{h as q,s as F}from"./eye-close-icon.545039e0.js";import te from"./auth.8c39c358.js";import{_ as se}from"./_plugin-vue_export-helper.c27b6911.js";import"./focus-trap.14e866f0.js";const _=b=>(oe("data-v-d595789c"),b=b(),ie(),b),re={class:"main"},le={class:"main__form"},ae=_(()=>s("div",{class:"main__form--title"},"Reset PIN",-1)),ue=_(()=>s("div",{class:"main__form--subtitle"},"Enter a new PIN below to change your PIN.",-1)),pe={key:0,class:"el-form-item__global-error-container"},me={class:"el-form-item__global-error"},de=_(()=>s("img",{src:S,alt:""},null,-1)),_e=_(()=>s("span",{for:"pin",class:"custom_placeholder"}," PIN ",-1)),ce=[_e],fe=["src"],ve={key:0,class:"el-form-item__error"},ge=["innerHTML"],be=_(()=>s("div",null,null,-1)),we=_(()=>s("span",{for:"password",class:"custom_placeholder"}," PIN Confirmation ",-1)),ye=[we],he=["src"],Ie={key:0,class:"el-form-item__error"},ke=["innerHTML"],Se=_(()=>s("div",null,null,-1)),Pe={class:"submit-button__text"},xe={__name:"reset",setup(b){const P=K(),{changePinData:B,changePinFailureData:L,isLoadingSubmit:x}=Q(P),g=ee(),w=X(),R=(n,e,r)=>{e===""?r(new Error("Please input the PIN again")):e!==l.value.pin?r(new Error("PIN and repeat PIN do not match.")):r()},H=(n,e,r)=>{/^\d{4,6}$/.test(e)?r():r(new Error(`<span>PIN is improperly formatted.<br></span>
            <ul class="error_info">
              <li>4-6 characters long.</li>
              <li>Should include only numbers.</li>
            </ul>`))},l=f({pin:null,pin_confirmation:null,pinToken:null}),i=f({pin:{value:"",isShow:!1},pin_confirmation:{value:"",isShow:!1},global:{value:""}}),j=f({pin:[{required:!0,message:"This field is required.",trigger:"blur"},{validator:H,trigger:"input"}],pin_confirmation:[{required:!0,message:"This field is required.",trigger:"blur"},{validator:R,trigger:"blur"}]}),y=f(!1),h=f(!1),E=f(!1);N(L,n=>{for(const e in n)if(typeof n[e]!="string")for(const r in n[e])i.value.global.value=n[e][r];else i.value.global.value=n[e]}),N(B,n=>{l.value={pin:null,pin_confirmation:null},ne("/")}),Y(()=>{te(),w.query.email&&(l.value.email=w.query.email),w.query.token&&(l.value.pinToken=w.query.token),window.addEventListener("resize",D)});const z=()=>{g.refs.resetForm.validate(n=>{if(n)P.changePin(l.value);else return i.value.global.value="Please fill empty areas",!1})},I=n=>{g.refs.resetForm.validateField(n,(e,r)=>{e?i.value[n].value="":i.value[n].value=r[n][0].message}),Object.values(l.value).every(e=>e)&&g.refs.resetForm.validate(e=>E.value=e)},d=()=>window.innerWidth>990,D=()=>{g.update()},c=(n,e)=>{d()?i.value[n].isShow=e==="mouseover":e==="click"&&(i.value[n].isShow=!0)},$=n=>{g.refs[n].focus()};return(n,e)=>{const r=G,k=O,A=J,U=W;return a(),p("div",re,[s("div",le,[ae,ue,v(U,{ref:"resetForm",class:"main__form--box","hide-required-asterisk":"",model:o(l),rules:o(j),onSubmit:Z(z,["prevent"])},{default:m(()=>[o(i).global.value?(a(),p("div",pe,[s("div",me,[de,s("span",null,C(o(i).global.value),1)])])):u("",!0),v(k,{prop:"pin",class:"password-form-item"},{error:m(()=>[o(i).pin.isShow&&d()?(a(),p("div",ve,[s("span",{innerHTML:o(i).pin.value},null,8,ge)])):u("",!0),be]),default:m(()=>[v(r,{id:"pin",ref:"pin",modelValue:o(l).pin,"onUpdate:modelValue":e[5]||(e[5]=t=>o(l).pin=t),type:o(y)?"text":"password",class:"main__form--box__input",placeholder:"Enter PIN",onBlur:e[6]||(e[6]=t=>I("pin")),onInput:e[7]||(e[7]=t=>I("pin"))},{suffix:m(()=>[o(l).pin?(a(),p("div",{key:0,style:{position:"relative"},onClick:e[0]||(e[0]=t=>$("pin"))},ce)):u("",!0),s("img",{class:V(o(i).pin.value?"eye_icon":""),src:o(y)?o(q):o(F),alt:"eye_icon",onClick:e[1]||(e[1]=t=>y.value=!o(y))},null,10,fe),o(i).pin.value?(a(),p("img",{key:1,src:S,alt:"",class:"error_icon",onMouseover:e[2]||(e[2]=t=>c("pin","mouseover")),onMouseout:e[3]||(e[3]=t=>c("pin","mouseout")),onClick:e[4]||(e[4]=t=>c("pin","click"))},null,32)):u("",!0)]),_:1},8,["modelValue","type"])]),_:1}),v(k,{prop:"pin_confirmation",class:"password-form-item"},{error:m(()=>[o(i).pin_confirmation.isShow&&d()?(a(),p("div",Ie,[s("span",{innerHTML:o(i).pin_confirmation.value},null,8,ke)])):u("",!0),Se]),default:m(()=>[v(r,{id:"pin_confirmation",ref:"pin_confirmation",modelValue:o(l).pin_confirmation,"onUpdate:modelValue":e[13]||(e[13]=t=>o(l).pin_confirmation=t),type:o(h)?"text":"password",class:"main__form--box__input",placeholder:"Repeat PIN",onBlur:e[14]||(e[14]=t=>I("pin_confirmation"))},{suffix:m(()=>[o(l).pin_confirmation?(a(),p("div",{key:0,style:{position:"relative"},onClick:e[8]||(e[8]=t=>$("pin_confirmation"))},ye)):u("",!0),s("img",{class:V(o(i).pin_confirmation.value?"eye_icon":""),src:o(h)?o(q):o(F),alt:"eye_icon",onClick:e[9]||(e[9]=t=>h.value=!o(h))},null,10,he),o(i).pin_confirmation.value?(a(),p("img",{key:1,src:S,alt:"",class:"error_icon",onMouseover:e[10]||(e[10]=t=>c("pin_confirmation","mouseover")),onMouseout:e[11]||(e[11]=t=>c("pin_confirmation","mouseout")),onClick:e[12]||(e[12]=t=>c("pin_confirmation","click"))},null,32)):u("",!0)]),_:1},8,["modelValue","type"])]),_:1}),v(A,{class:"submit-button","native-type":"submit",loading:o(x),disabled:!o(E)},{default:m(()=>[s("span",Pe,C(o(x)?"":"Save"),1)]),_:1},8,["loading","disabled"]),o(i).pin.isShow&&!d()?(a(),M(T,{key:1,"dialog-visible":o(i).pin.isShow&&!d(),"error-text":o(i).pin.value,onVisible:e[15]||(e[15]=t=>o(i).pin.isShow=!1)},null,8,["dialog-visible","error-text"])):u("",!0),o(i).pin_confirmation.isShow&&!d()?(a(),M(T,{key:2,"dialog-visible":o(i).pin_confirmation.isShow&&!d(),"error-text":o(i).pin_confirmation.value,onVisible:e[16]||(e[16]=t=>o(i).pin_confirmation.isShow=!1)},null,8,["dialog-visible","error-text"])):u("",!0)]),_:1},8,["model","rules","onSubmit"])])])}}},Be=se(xe,[["__scopeId","data-v-d595789c"]]);export{Be as default};
