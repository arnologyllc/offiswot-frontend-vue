import{E as R,_ as C,a as j,b as G}from"./el-overlay.1f0c4351.js";import{E as W}from"./el-checkbox.574b18b8.js";import{E as X}from"./el-button.c5c7c37a.js";import"./el-form-item.4ed993c7.js";import{D as K,s as Q,r as v,w as B,e as Y,f as c,m as a,h as f,i as n,u as s,j as Z,c as D,k as d,l as ee,o as u,t as q,E as oe,q as V,y as se,v as le,x as te,G as g}from"./entry.b1b4faa5.js";import{_ as ae,a as re}from"./OvConfirmEmailModal.0782db19.js";import{_ as ie}from"./lock-icon.1cd039b7.js";import{L as ne}from"./LoginButtons.fff339b3.js";import{E as N}from"./ErrorMassageModal.e5ae7b26.js";import{h as ue,s as me}from"./eye-close-icon.e2e94819.js";import{_ as de}from"./_plugin-vue_export-helper.c27b6911.js";import"./focus-trap.84023b48.js";import"./isEqual.208c5e4f.js";import"./flatten.2c3feb2a.js";import"./email-primary-icon.f9c04343.js";import"./chevron-icon.1dc13603.js";const m=b=>(le("data-v-bfaf7761"),b=b(),te(),b),pe={class:"main"},_e={class:"main__form"},ce=m(()=>a("div",{class:"main__form--title"},"Log In",-1)),fe=m(()=>a("div",{class:"main__form--subtitle"},"Please fill the forms to log in",-1)),ve={key:0,class:"el-form-item__global-error-container"},ge={class:"el-form-item__global-error"},we=m(()=>a("img",{src:C,alt:""},null,-1)),ke=m(()=>a("img",{src:re,alt:"user_icon"},null,-1)),be=m(()=>a("span",{for:"email",class:"custom_placeholder"}," Email or username ",-1)),ye=[be],Se=m(()=>a("div",null,null,-1)),he={key:0,class:"el-form-item__error"},xe=m(()=>a("div",null,null,-1)),Ee=m(()=>a("img",{src:ie,alt:"password_icon"},null,-1)),Ie=m(()=>a("span",{for:"password",class:"custom_placeholder"}," Password ",-1)),$e=[Ie],De=["src"],Ve={key:0,class:"el-form-item__error"},Ce=["innerHTML"],Te=m(()=>a("div",null,null,-1)),Fe={class:"forgot-password"},Le=m(()=>a("span",{style:{"font-weight":"400"}},"Remember me",-1)),Me={__name:"login",setup(b){const E=K(),{loginSuccessData:O,loginErrorData:U}=Q(E),y=ee(),S=v(!1),h=v(!1),x=v(!1),w=v({ID:null,email:null,avatarUrl:null,token:null,token_expires:null,first_login:null,settings_pin_token:null,login_pin_token:null,login_pin_token_expires:null,workspaces:null}),i=v({email:null,password:null,remember_me:!1}),l=v({email:{value:"",isShow:!1},password:{value:"",isShow:!1},global:{value:""}}),H=v({email:[{required:!0,message:"This field is required.",trigger:"blur"}],password:[{required:!0,message:"This field is required.",trigger:"blur"}]});B(O,o=>{g.remove("token"),g.remove("first_login"),g.remove("settings_pin_token"),g.remove("login_pin_token"),g.remove("addAccount"),x.value=localStorage.getItem("accounts")!=="undefined"?JSON.parse(localStorage.getItem("accounts")):[];const[e,r]=[o.access_token,o.is_first_login],p=i.value.remember_me?null:1/24,k=new Date;k.setHours(k.getHours()+1),p?w.value.token_expires=k:w.value.token_expires=null,g.set("token",e,{expires:p}),w.value.email=o.user.email,w.value.token=e,w.value.first_login=r,x.value.push(w.value),x.value.forEach((I,$)=>I.ID=$),localStorage.setItem("accounts",JSON.stringify(x.value)),r?(V("/pin"),g.set("first_login",r)):V("/")}),B(U,o=>{if((o==="Please visit your email to verify your account."||(o==null?void 0:o.error)==="Please visit your email to verify your account.")&&(h.value=!0),o==="Incorrect username or password."&&(l.value.global.value=o),typeof o!="string")for(const e in o)if(typeof o[e]!="string")for(const r in o[e])l.value.global.value=o[e][r];else l.value.global.value=o[e]}),Y(()=>{const o=new Date;o.setDate(o.getDate()+30),window.addEventListener("resize",z)});const J=()=>{y.refs.loginForm.validate(o=>{var e;if(o){const r=localStorage.getItem("accounts")!=="undefined"?(e=JSON.parse(localStorage.getItem("accounts")))==null?void 0:e.filter(p=>Date.parse(p.token_expires)>new Date):[];r!=null&&r.some(p=>p.email===i.value.email)?l.value.global.value="Account already logined":(localStorage.setItem("accounts",JSON.stringify(r)),E.loginUser(i.value))}else return l.value.global.value="Please fill empty areas",!1})},T=o=>{y.refs[o].focus()},F=o=>{y.refs.loginForm.validateField(o,(e,r)=>{e?l.value[o].value="":l.value[o].value=r[o][0].message})},L=o=>{l.value[o].isShow=!0},M=o=>{_()&&(l.value[o].isShow=!0)},P=o=>{_()&&(l.value[o].isShow=!1)},z=()=>{y.update()},_=()=>window.innerWidth>990,A=()=>{l.value.global.value=""};return(o,e)=>{const r=j,p=G,k=W,I=X,$=R;return u(),c("div",pe,[a("div",_e,[ce,fe,f($,{ref:"loginForm",class:"main__form--box","hide-required-asterisk":"",model:s(i),rules:s(H),onSubmit:Z(J,["prevent"])},{default:n(()=>[s(l).global.value?(u(),c("div",ve,[a("div",ge,[we,a("span",null,q(s(l).global.value),1)]),a("span",{class:"clear-error",onClick:A},"X")])):d("",!0),f(p,{prop:"email"},{error:n(()=>[s(l).email.isShow&&_()?(u(),c("div",he,[a("span",null,q(s(l).email.value),1)])):d("",!0),xe]),default:n(()=>[f(r,{ref:"email",modelValue:s(i).email,"onUpdate:modelValue":e[4]||(e[4]=t=>s(i).email=t),class:"main__form--box__input",placeholder:"Email or username",onBlur:e[5]||(e[5]=t=>F("email"))},{prefix:n(()=>[ke]),suffix:n(()=>[s(l).email.value?(u(),c("img",{key:0,class:"error_icon",src:C,alt:"",onMouseover:e[0]||(e[0]=t=>M("email")),onMouseout:e[1]||(e[1]=t=>P("email")),onClick:e[2]||(e[2]=t=>L("email"))},null,32)):d("",!0),s(i).email?(u(),c("div",{key:1,style:{position:"relative"},onClick:e[3]||(e[3]=t=>T("email"))},ye)):d("",!0),Se]),_:1},8,["modelValue"])]),_:1}),f(p,{prop:"password",class:"password-form-item"},{error:n(()=>[s(l).password.isShow&&_()?(u(),c("div",Ve,[a("span",{innerHTML:s(l).password.value},null,8,Ce)])):d("",!0),Te]),default:n(()=>[f(r,{id:"password",ref:"password",modelValue:s(i).password,"onUpdate:modelValue":e[11]||(e[11]=t=>s(i).password=t),type:s(S)?"text":"password",class:"main__form--box__input",placeholder:"Password",onBlur:e[12]||(e[12]=t=>F("password"))},{prefix:n(()=>[Ee]),suffix:n(()=>[s(i).password?(u(),c("div",{key:0,style:{position:"relative"},onClick:e[6]||(e[6]=t=>T("password"))},$e)):d("",!0),a("img",{class:oe(s(l).password.value?"eye_icon":""),src:s(S)?s(ue):s(me),alt:"eye_icon",onClick:e[7]||(e[7]=t=>S.value=!s(S))},null,10,De),s(l).password.value?(u(),c("img",{key:1,src:C,alt:"",class:"error_icon",onMouseover:e[8]||(e[8]=t=>M("password")),onMouseout:e[9]||(e[9]=t=>P("password")),onClick:e[10]||(e[10]=t=>L("password"))},null,32)):d("",!0)]),_:1},8,["modelValue","type"]),a("div",Fe,[f(k,{modelValue:s(i).remember_me,"onUpdate:modelValue":e[13]||(e[13]=t=>s(i).remember_me=t),class:"remember-checkbox"},{default:n(()=>[Le]),_:1},8,["modelValue"]),f(I,{text:"",onClick:e[14]||(e[14]=t=>("navigateTo"in o?o.navigateTo:s(V))("/password/forgot"))},{default:n(()=>[se("Forgot Password?")]),_:1})])]),_:1}),f(ne,{"login-loading":s(E).loginLoading,"login-title":"Log In","social-title":"Sign in with Google"},null,8,["login-loading"])]),_:1},8,["model","rules","onSubmit"])]),s(h)?(u(),D(ae,{key:0,email:s(i).email,"dialog-visible":s(h),onClose:e[15]||(e[15]=t=>h.value=!1)},null,8,["email","dialog-visible"])):d("",!0),s(l).email.isShow&&!_()?(u(),D(N,{key:1,"dialog-visible":s(l).email.isShow&&!_(),"error-text":s(l).email.value,onVisible:e[16]||(e[16]=t=>s(l).email.isShow=!1)},null,8,["dialog-visible","error-text"])):d("",!0),s(l).password.isShow&&!_()?(u(),D(N,{key:2,"dialog-visible":s(l).password.isShow&&!_(),"error-text":s(l).password.value,onVisible:e[17]||(e[17]=t=>s(l).password.isShow=!1)},null,8,["dialog-visible","error-text"])):d("",!0)])}}},Qe=de(Me,[["__scopeId","data-v-bfaf7761"]]);export{Qe as default};
