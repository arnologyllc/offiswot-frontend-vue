import{E as ts,_ as T,a as rs,b as as}from"./el-overlay.e1aafefe.js";import{E as is}from"./el-button.9b2a4498.js";import{G as ls,s as D,b as ns,e as ds,r as f,w as P,f as us,i as u,j as a,u as o,k as v,l as p,m as ps,c as $,p as d,q as ms,o as n,t as H,B as V,A as _s,x as ws,y as fs,z as vs}from"./entry.f9d94662.js";import{_ as cs}from"./chevron-left.fc36a491.js";import{_ as gs,a as bs}from"./good.3130094e.js";import{_ as ys}from"./OvConfirmPasswordChangeModal.5c857150.js";import{_ as ks}from"./AccessCheckModal.508a4259.js";import{E as B}from"./ErrorMassageModal.494fa3a4.js";import{h as R,s as q}from"./eye-close-icon.b0dc716b.js";import Ss from"./settingsToken.0e88acfe.js";import $s from"./loginToken.2314deee.js";import hs from"./auth.836980c0.js";import{_ as xs}from"./_plugin-vue_export-helper.c27b6911.js";import"./focus-trap.2e8a2bfe.js";import"./email-primary-icon.e7cfb062.js";const c=h=>(ws("data-v-8e6bacd4"),h=h(),fs(),h),Ms={class:"main"},Cs={class:"main__form"},Es={class:"main__form--title"},Ps=c(()=>a("span",null,"Reset password",-1)),Vs=c(()=>a("div",{class:"main__form--subtitle"},"Fill in the fields to change your password.",-1)),Ts={key:0,class:"el-form-item__global-error-container"},Is={class:"el-form-item__global-error"},Ls=c(()=>a("img",{src:T,alt:""},null,-1)),zs=c(()=>a("span",{for:"old_password",class:"custom_placeholder"}," Old Password ",-1)),Fs=[zs],Bs=["src"],Rs={key:0,class:"el-form-item__error"},qs=["innerHTML"],As=c(()=>a("div",null,null,-1)),Ds=c(()=>a("span",{for:"password",class:"custom_placeholder"}," New password ",-1)),Hs=[Ds],Ws=["src"],Os={key:0,src:gs,alt:""},js={key:1,src:bs,alt:""},Zs={key:2,src:T,alt:""},Us=["innerHTML"],Gs={key:0,class:"el-form-item__error"},Ns=["innerHTML"],Xs=c(()=>a("div",null,null,-1)),Js=c(()=>a("span",{for:"password",class:"custom_placeholder"}," Repeat Password ",-1)),Ks=[Js],Qs=["src"],Ys={key:0,class:"el-form-item__error"},so=["innerHTML"],oo=c(()=>a("div",null,null,-1)),eo={class:"forgot-password"},to={class:"submit-button__text"},ro={__name:"reset",setup(h){const I=ls(),{resetSuccessData:W,resetErrorData:O,resetLoading:A,forgotSuccessData:j,forgotErrorData:Z}=D(I),U=ns(),{profileSuccessData:L}=D(U),x=ms(),G=ds(),b=f(!1),y=f(!1),M=f(!1),C=f(!1),E=f(!1),z=f(!1),N=(t,s,l)=>{s||l(new Error("This field is required"));const w=os(s);w==="Weak"?(l(new Error("Password strength: <b>Weak</b>")),e.value.password.status="Weak"):w==="Medium"?(l(),e.value.password.status="Medium",e.value.password.value="Password strength: <b>Medium</b>"):w==="Strong"&&(l(),e.value.password.status="Strong",e.value.password.value="Password strength: <b>Strong</b>")},X=(t,s,l)=>{s===""?l(new Error("Please input the password again")):s!==i.value.password?l(new Error("Password and confirm password do not match")):l()},i=f({old_password:null,password:null,password_confirmation:null}),e=f({old_password:{value:"",isShow:!1},password:{value:"",isShow:!1},password_confirmation:{value:"",isShow:!1},global:{value:""}}),J=f({old_password:[{required:!0,message:"This field is required.",trigger:"blur"}],password:[{validator:N,trigger:"input"}],password_confirmation:[{required:!0,message:"This field is required.",trigger:"blur"},{validator:X,trigger:"blur"}]});P(O,t=>{for(const s in t)if(typeof t[s]!="string")for(const l in t[s])e.value.global.value=t[s][l];else e.value.global.value=t[s]}),P(W,t=>{vs("/")}),P(Z,t=>{if(!y.value)for(const s in t)if(typeof t[s]!="string")for(const l in t[s])e.value.global.value=t[s][l];else e.value.global.value=t[s]}),P(j,t=>{var s;t&&(i.value.email=(s=L.value)==null?void 0:s.user.email,y.value=!0)}),us(()=>{var t,s;hs(),(t=L.value)!=null&&t.user.email&&(i.value.email=(s=L.value)==null?void 0:s.user.email),b.value=$s(),b.value=Ss(),window.addEventListener("resize",Y)});const K=()=>{I.resetPasswordWithSettings(i.value)},Q=()=>{I.forgotPasswordWithMail(i.value)},F=t=>{x.refs[t].focus()},g=t=>{x.refs.passwordForm.validateField(t,(s,l)=>{s?t!=="password"&&(e.value[t].value=""):e.value[t].value=l[t][0].message}),Object.values(i.value).every(s=>s)?x.refs.passwordForm.validate(s=>z.value=s):z.value=!1},_=(t,s)=>{m()?e.value[t].isShow=s==="mouseover":s==="click"&&(e.value[t].isShow=!0)},Y=()=>{x.update()},m=()=>window.innerWidth>990,ss=()=>{e.value.global.value=""},os=t=>{const s=/^(?=.*[a-zA-Z])(?=.*[\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?])[a-zA-Z\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]{8,}$/,l=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?])[a-zA-Z\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]{12,}$/,w=/^(?:(.)(?!\1{3}))*$/,k=["password","admin","qwerty","asdfgh","zxcvb"];if(w.test(t)&&((t==null?void 0:t.length)>15||!k.some(S=>t==null?void 0:t.toLowerCase().includes(S)))){if(l.test(t)&&((t==null?void 0:t.length)>25||!k.some(S=>t==null?void 0:t.toLowerCase().includes(S))))return"Strong";if(s.test(t))return"Medium"}return"Weak"},es=()=>{switch(e.value.password.status){case"Medium":return"warning";case"Strong":return"done";default:return""}};return(t,s)=>{const l=rs,w=as,k=is,S=ts;return n(),u("div",Ms,[a("div",Cs,[a("div",Es,[a("img",{src:cs,alt:"chevron-left",onClick:s[0]||(s[0]=r=>o(G).go(-1))}),Ps]),Vs,v(S,{ref:"passwordForm",class:"main__form--box","hide-required-asterisk":"",model:o(i),rules:o(J),onSubmit:ps(K,["prevent"])},{default:p(()=>[o(e).global.value?(n(),u("div",Ts,[a("div",Is,[Ls,a("span",null,H(o(e).global.value),1)]),a("span",{class:"clear-error",onClick:ss},"X")])):d("",!0),v(w,{prop:"old_password",class:"password-form-item"},{error:p(()=>[o(e).old_password.isShow&&m()?(n(),u("div",Rs,[a("span",{innerHTML:o(e).old_password.value},null,8,qs)])):d("",!0),As]),default:p(()=>[v(l,{id:"old_password",ref:"old_password",modelValue:o(i).old_password,"onUpdate:modelValue":s[6]||(s[6]=r=>o(i).old_password=r),type:o(M)?"text":"password",class:"main__form--box__input",placeholder:"Old password",onInput:s[7]||(s[7]=r=>g("old_password")),onBlur:s[8]||(s[8]=r=>g("old_password"))},{suffix:p(()=>[o(i).old_password?(n(),u("div",{key:0,style:{position:"relative"},onClick:s[1]||(s[1]=r=>F("old_password"))},Fs)):d("",!0),a("img",{class:V(o(e).old_password.value?"eye_icon":""),src:o(M)?o(R):o(q),alt:"eye_icon",onClick:s[2]||(s[2]=r=>M.value=!o(M))},null,10,Bs),o(e).old_password.value?(n(),u("img",{key:1,src:T,alt:"",class:"error_icon",onMouseover:s[3]||(s[3]=r=>_("old_password","mouseover")),onMouseout:s[4]||(s[4]=r=>_("old_password","mouseout")),onClick:s[5]||(s[5]=r=>_("old_password","click"))},null,32)):d("",!0)]),_:1},8,["modelValue","type"])]),_:1}),v(w,{prop:"password",class:"form-item"},{error:p(()=>[!o(i).password&&o(e).password.isShow&&m()?(n(),u("div",Gs,[a("span",{innerHTML:o(e).password.value},null,8,Ns)])):d("",!0),Xs]),default:p(()=>[v(l,{ref:"password",modelValue:o(i).password,"onUpdate:modelValue":s[14]||(s[14]=r=>o(i).password=r),class:"main__form--box__input",placeholder:"Password",type:o(C)?"text":"password",onInput:s[15]||(s[15]=r=>g("password")),onBlur:s[16]||(s[16]=r=>g("password"))},{suffix:p(()=>[o(i).password?(n(),u("div",{key:0,style:{position:"relative"},onClick:s[9]||(s[9]=r=>F("password"))},Hs)):d("",!0),a("img",{class:V(o(e).password.value?"eye_icon":""),src:o(C)?o(R):o(q),alt:"eye_icon",onClick:s[10]||(s[10]=r=>C.value=!o(C))},null,10,Ws),o(e).password.value?(n(),u("div",{key:1,class:"error_icon",onMouseover:s[11]||(s[11]=r=>_("password","mouseover")),onMouseout:s[12]||(s[12]=r=>_("password","mouseout")),onClick:s[13]||(s[13]=r=>_("password","click"))},[o(e).password.status==="Medium"&&o(i).password?(n(),u("img",Os)):o(e).password.status==="Strong"&&o(i).password?(n(),u("img",js)):(n(),u("img",Zs))],32)):d("",!0),o(i).password&&o(e).password.isShow&&m()?(n(),u("div",{key:2,class:V([es(),"el-form-item__error strength"])},[a("span",{innerHTML:o(e).password.value},null,8,Us)],2)):d("",!0)]),_:1},8,["modelValue","type"])]),_:1}),v(w,{prop:"password_confirmation",class:"password-form-item"},{error:p(()=>[o(e).password_confirmation.isShow&&m()?(n(),u("div",Ys,[a("span",{innerHTML:o(e).password_confirmation.value},null,8,so)])):d("",!0),oo]),default:p(()=>[v(l,{id:"password_confirmation",ref:"password_confirmation",modelValue:o(i).password_confirmation,"onUpdate:modelValue":s[22]||(s[22]=r=>o(i).password_confirmation=r),type:o(E)?"text":"password",class:"main__form--box__input",placeholder:"Repeat password",onInput:s[23]||(s[23]=r=>g("password_confirmation")),onBlur:s[24]||(s[24]=r=>g("password_confirmation"))},{suffix:p(()=>[o(i).password_confirmation?(n(),u("div",{key:0,style:{position:"relative"},onClick:s[17]||(s[17]=r=>F("password_confirmation"))},Ks)):d("",!0),a("img",{class:V(o(e).password_confirmation.value?"eye_icon":""),src:o(E)?o(R):o(q),alt:"eye_icon",onClick:s[18]||(s[18]=r=>E.value=!o(E))},null,10,Qs),o(e).password_confirmation.value?(n(),u("img",{key:1,src:T,alt:"",class:"error_icon",onMouseover:s[19]||(s[19]=r=>_("password_confirmation","mouseover")),onMouseout:s[20]||(s[20]=r=>_("password_confirmation","mouseout")),onClick:s[21]||(s[21]=r=>_("password_confirmation","click"))},null,32)):d("",!0)]),_:1},8,["modelValue","type"])]),_:1}),a("div",eo,[v(k,{style:{"font-size":"14px","font-weight":"400"},onClick:Q},{default:p(()=>[_s("Forgot Password?")]),_:1})]),v(k,{class:"submit-button","native-type":"submit",loading:o(A),disabled:!o(z)},{default:p(()=>[a("span",to,H(o(A)?"":"Save"),1)]),_:1},8,["loading","disabled"]),o(e).old_password.isShow&&!m()?(n(),$(B,{key:1,"dialog-visible":o(e).old_password.isShow&&!m(),"error-text":o(e).old_password.value,onVisible:s[25]||(s[25]=r=>o(e).old_password.isShow=!1)},null,8,["dialog-visible","error-text"])):d("",!0),o(e).password.isShow&&!m()?(n(),$(B,{key:2,"dialog-visible":o(e).password.isShow&&!m(),"error-text":o(e).password.value,"text-color":o(e).password.status==="Medium"&&o(i).password?"warning":o(e).password.status==="Strong"&&o(i).password?"done":"weak",onVisible:s[26]||(s[26]=r=>o(e).password.isShow=!1)},null,8,["dialog-visible","error-text","text-color"])):d("",!0),o(e).password_confirmation.isShow&&!m()?(n(),$(B,{key:3,"dialog-visible":o(e).password_confirmation.isShow&&!m(),"error-text":o(e).password_confirmation.value,onVisible:s[27]||(s[27]=r=>o(e).password_confirmation.isShow=!1)},null,8,["dialog-visible","error-text"])):d("",!0)]),_:1},8,["model","rules","onSubmit"])]),o(y)?(n(),$(ys,{key:0,email:o(i).email,"dialog-visible":o(y),onClose:s[28]||(s[28]=r=>y.value=!1)},null,8,["email","dialog-visible"])):d("",!0),o(b)?(n(),$(ks,{key:1,"dialog-visible":o(b),onClose:s[29]||(s[29]=r=>b.value=!1)},null,8,["dialog-visible"])):d("",!0)])}}},ko=xs(ro,[["__scopeId","data-v-8e6bacd4"]]);export{ko as default};
