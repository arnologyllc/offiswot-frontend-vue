import{E as ts,_ as P,a as as,b as is}from"./el-overlay.1f0c4351.js";import{E as ls}from"./el-button.c5c7c37a.js";import"./el-form-item.4ed993c7.js";import{D as ns,s as W,z as ds,b as us,r as v,w as M,e as ps,f as u,m as a,u as o,h as w,i as _,j as _s,c as h,k as d,l as ms,o as n,t as A,E as C,y as ws,v as fs,x as vs,q as cs}from"./entry.b1b4faa5.js";import{_ as gs}from"./chevron-left.2bdcdcea.js";import{_ as ys,a as bs}from"./good.59e80b81.js";import{_ as hs}from"./OvConfirmPasswordChangeModal.6f98b690.js";import{_ as Ss}from"./AccessCheckModal.ff03b1d4.js";import{E as R}from"./ErrorMassageModal.e5ae7b26.js";import{h as q,s as B}from"./eye-close-icon.e2e94819.js";import ks from"./settingsToken.e32b09ee.js";import $s from"./loginToken.0d7ab56d.js";import xs from"./auth.e56a6310.js";import{_ as Es}from"./_plugin-vue_export-helper.c27b6911.js";import"./focus-trap.84023b48.js";import"./email-primary-icon.f9c04343.js";const f=S=>(fs("data-v-dea998cc"),S=S(),vs(),S),Ms={class:"main"},Cs={class:"main__form"},Ps={class:"main__form--title"},Ts=f(()=>a("span",null,"Reset password",-1)),Vs=f(()=>a("div",{class:"main__form--subtitle"},"Fill in the fields to change your password.",-1)),Ls={key:0,class:"el-form-item__global-error-container"},Is={class:"el-form-item__global-error"},zs=f(()=>a("img",{src:P,alt:""},null,-1)),Ds=f(()=>a("span",{for:"old_password",class:"custom_placeholder"}," Old Password ",-1)),Fs=[Ds],Rs=["src"],qs={key:0,class:"el-form-item__error"},Bs=["innerHTML"],Hs=f(()=>a("div",null,null,-1)),Ws=f(()=>a("span",{for:"password",class:"custom_placeholder"}," New password ",-1)),As=[Ws],Os=["src"],Zs={key:0,src:ys,alt:""},js={key:1,src:bs,alt:""},Us={key:2,src:P,alt:""},Ns=["innerHTML"],Xs={key:0,class:"el-form-item__error"},Gs=["innerHTML"],Js=f(()=>a("div",null,null,-1)),Ks=f(()=>a("span",{for:"password",class:"custom_placeholder"}," Repeat Password ",-1)),Qs=[Ks],Ys=["src"],so={key:0,class:"el-form-item__error"},oo=["innerHTML"],eo=f(()=>a("div",null,null,-1)),ro={class:"forgot-password"},to={class:"submit-button__text"},ao={__name:"reset",setup(S){const T=ns(),{resetSuccessData:O,resetErrorData:Z,resetLoading:H,forgotSuccessData:j,forgotErrorData:U}=W(T),N=ds(),{profileSuccessData:V}=W(N),L=ms(),X=us(),c=v(!1),g=v(!1),k=v(!1),$=v(!1),x=v(!1),G=(e,s,l)=>{s||l(new Error("This field is required"));const m=es(s);m==="Weak"?(l(new Error("Password strength: <b>Weak</b>")),r.value.password.status="Weak"):m==="Medium"?(l(),r.value.password.status="Medium",r.value.password.value="Password strength: <b>Medium</b>"):m==="Strong"&&(l(),r.value.password.status="Strong",r.value.password.value="Password strength: <b>Strong</b>")},J=(e,s,l)=>{s===""?l(new Error("Please input the password again")):s!==i.value.password?l(new Error("Password and confirm password do not match")):l()},i=v({old_password:null,password:null,password_confirmation:null}),r=v({old_password:{value:"",isShow:!1},password:{value:"",isShow:!1},password_confirmation:{value:"",isShow:!1},global:{value:""}}),K=v({old_password:[{required:!0,message:"This field is required.",trigger:"blur"}],password:[{validator:G,trigger:"input"}],password_confirmation:[{required:!0,message:"This field is required.",trigger:"blur"},{validator:J,trigger:"blur"}]});M(Z,e=>{for(const s in e)if(typeof e[s]!="string")for(const l in e[s])r.value.global.value=e[s][l];else r.value.global.value=e[s]}),M(O,e=>{cs("/")}),M(U,e=>{if(!g.value)for(const s in e)if(typeof e[s]!="string")for(const l in e[s])r.value.global.value=e[s][l];else r.value.global.value=e[s]}),M(j,e=>{var s;e&&(i.value.email=(s=V.value)==null?void 0:s.user.email,g.value=!0)}),ps(()=>{var e,s;xs(),(e=V.value)!=null&&e.user.email&&(i.value.email=(s=V.value)==null?void 0:s.user.email),c.value=$s(),c.value=ks(),window.addEventListener("resize",ss)});const Q=()=>{T.resetPasswordWithSettings(i.value)},Y=()=>{T.forgotPasswordWithMail(i.value)},I=e=>{L.refs[e].focus()},E=e=>{L.refs.passwordForm.validateField(e,(s,l)=>{s?e!=="password"&&(r.value[e].value=""):r.value[e].value=l[e][0].message})},z=e=>{r.value[e].isShow=!0},D=e=>{p()&&(r.value[e].isShow=!0)},F=e=>{p()&&(r.value[e].isShow=!1)},ss=()=>{L.update()},p=()=>window.innerWidth>990,os=()=>{r.value.global.value=""},es=e=>{const s=/^(?=.*[a-zA-Z])(?=.*[\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?])[a-zA-Z\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]{8,}$/,l=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?])[a-zA-Z\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]{12,}$/,m=/^(?:(.)(?!\1{3}))*$/,y=["password","admin","qwerty","asdfgh","xzcvb"];if(m.test(e)&&((e==null?void 0:e.length)>15||!y.some(b=>e==null?void 0:e.toLowerCase().includes(b)))){if(l.test(e)&&((e==null?void 0:e.length)>25||!y.some(b=>e==null?void 0:e.toLowerCase().includes(b))))return"Strong";if(s.test(e))return"Medium"}return"Weak"},rs=()=>r.value.password.status==="Medium"?"warning":r.value.password.status==="Strong"?"done":"";return(e,s)=>{const l=as,m=is,y=ls,b=ts;return n(),u("div",Ms,[a("div",Cs,[a("div",Ps,[a("img",{src:gs,alt:"chevron-left",onClick:s[0]||(s[0]=t=>o(X).go(-1))}),Ts]),Vs,w(b,{ref:"passwordForm",class:"main__form--box","hide-required-asterisk":"",model:o(i),rules:o(K),onSubmit:_s(Q,["prevent"])},{default:_(()=>[o(r).global.value?(n(),u("div",Ls,[a("div",Is,[zs,a("span",null,A(o(r).global.value),1)]),a("span",{class:"clear-error",onClick:os},"X")])):d("",!0),w(m,{prop:"old_password",class:"password-form-item"},{error:_(()=>[o(r).old_password.isShow&&p()?(n(),u("div",qs,[a("span",{innerHTML:o(r).old_password.value},null,8,Bs)])):d("",!0),Hs]),default:_(()=>[w(l,{id:"old_password",ref:"old_password",modelValue:o(i).old_password,"onUpdate:modelValue":s[6]||(s[6]=t=>o(i).old_password=t),type:o(k)?"text":"password",class:"main__form--box__input",placeholder:"Old password",onBlur:s[7]||(s[7]=t=>E("old_password"))},{suffix:_(()=>[o(i).old_password?(n(),u("div",{key:0,style:{position:"relative"},onClick:s[1]||(s[1]=t=>I("old_password"))},Fs)):d("",!0),a("img",{class:C(o(r).old_password.value?"eye_icon":""),src:o(k)?o(q):o(B),alt:"eye_icon",onClick:s[2]||(s[2]=t=>k.value=!o(k))},null,10,Rs),o(r).old_password.value?(n(),u("img",{key:1,src:P,alt:"",class:"error_icon",onMouseover:s[3]||(s[3]=t=>D("old_password")),onMouseout:s[4]||(s[4]=t=>F("old_password")),onClick:s[5]||(s[5]=t=>z("old_password"))},null,32)):d("",!0)]),_:1},8,["modelValue","type"])]),_:1}),w(m,{prop:"password",class:"form-item"},{error:_(()=>[!o(i).password&&o(r).password.isShow&&p()?(n(),u("div",Xs,[a("span",{innerHTML:o(r).password.value},null,8,Gs)])):d("",!0),Js]),default:_(()=>[w(l,{ref:"password",modelValue:o(i).password,"onUpdate:modelValue":s[13]||(s[13]=t=>o(i).password=t),class:"main__form--box__input",placeholder:"Password",type:o($)?"text":"password",onInput:s[14]||(s[14]=t=>E("password")),onBlur:s[15]||(s[15]=t=>E("password"))},{suffix:_(()=>[o(i).password?(n(),u("div",{key:0,style:{position:"relative"},onClick:s[8]||(s[8]=t=>I("password"))},As)):d("",!0),a("img",{class:C(o(r).password.value?"eye_icon":""),src:o($)?o(q):o(B),alt:"eye_icon",onClick:s[9]||(s[9]=t=>$.value=!o($))},null,10,Os),o(r).password.value?(n(),u("div",{key:1,class:"error_icon",onMouseover:s[10]||(s[10]=t=>D("password")),onMouseout:s[11]||(s[11]=t=>F("password")),onClick:s[12]||(s[12]=t=>z("password"))},[o(r).password.status==="Medium"&&o(i).password?(n(),u("img",Zs)):o(r).password.status==="Strong"&&o(i).password?(n(),u("img",js)):(n(),u("img",Us))],32)):d("",!0),o(i).password&&o(r).password.isShow&&p()?(n(),u("div",{key:2,class:C([rs(),"el-form-item__error strength"])},[a("span",{innerHTML:o(r).password.value},null,8,Ns)],2)):d("",!0)]),_:1},8,["modelValue","type"])]),_:1}),w(m,{prop:"password_confirmation",class:"password-form-item"},{error:_(()=>[o(r).password_confirmation.isShow&&p()?(n(),u("div",so,[a("span",{innerHTML:o(r).password_confirmation.value},null,8,oo)])):d("",!0),eo]),default:_(()=>[w(l,{id:"password_confirmation",ref:"password_confirmation",modelValue:o(i).password_confirmation,"onUpdate:modelValue":s[21]||(s[21]=t=>o(i).password_confirmation=t),type:o(x)?"text":"password",class:"main__form--box__input",placeholder:"Repeat password",onBlur:s[22]||(s[22]=t=>E("password_confirmation"))},{suffix:_(()=>[o(i).password_confirmation?(n(),u("div",{key:0,style:{position:"relative"},onClick:s[16]||(s[16]=t=>I("password_confirmation"))},Qs)):d("",!0),a("img",{class:C(o(r).password_confirmation.value?"eye_icon":""),src:o(x)?o(q):o(B),alt:"eye_icon",onClick:s[17]||(s[17]=t=>x.value=!o(x))},null,10,Ys),o(r).password_confirmation.value?(n(),u("img",{key:1,src:P,alt:"",class:"error_icon",onMouseover:s[18]||(s[18]=t=>D("password_confirmation")),onMouseout:s[19]||(s[19]=t=>F("password_confirmation")),onClick:s[20]||(s[20]=t=>z("password_confirmation"))},null,32)):d("",!0)]),_:1},8,["modelValue","type"])]),_:1}),a("div",ro,[w(y,{style:{"font-size":"14px","font-weight":"400"},onClick:Y},{default:_(()=>[ws("Forgot Password?")]),_:1})]),w(y,{class:"submit-button","native-type":"submit",loading:o(H)},{default:_(()=>[a("span",to,A(o(H)?"":"Save"),1)]),_:1},8,["loading"]),o(r).old_password.isShow&&!p()?(n(),h(R,{key:1,"dialog-visible":o(r).old_password.isShow&&!p(),"error-text":o(r).old_password.value,onVisible:s[23]||(s[23]=t=>o(r).old_password.isShow=!1)},null,8,["dialog-visible","error-text"])):d("",!0),o(r).password.isShow&&!p()?(n(),h(R,{key:2,"dialog-visible":o(r).password.isShow&&!p(),"error-text":o(r).password.value,"text-color":o(r).password.status==="Medium"&&o(i).password?"warning":o(r).password.status==="Strong"&&o(i).password?"done":"weak",onVisible:s[24]||(s[24]=t=>o(r).password.isShow=!1)},null,8,["dialog-visible","error-text","text-color"])):d("",!0),o(r).password_confirmation.isShow&&!p()?(n(),h(R,{key:3,"dialog-visible":o(r).password_confirmation.isShow&&!p(),"error-text":o(r).password_confirmation.value,onVisible:s[25]||(s[25]=t=>o(r).password_confirmation.isShow=!1)},null,8,["dialog-visible","error-text"])):d("",!0)]),_:1},8,["model","rules","onSubmit"])]),o(g)?(n(),h(hs,{key:0,email:o(i).email,"dialog-visible":o(g),onClose:s[26]||(s[26]=t=>g.value=!1)},null,8,["email","dialog-visible"])):d("",!0),o(c)?(n(),h(Ss,{key:1,"dialog-visible":o(c),onClose:s[27]||(s[27]=t=>c.value=!1)},null,8,["dialog-visible"])):d("",!0)])}}},ko=Es(ao,[["__scopeId","data-v-dea998cc"]]);export{ko as default};
