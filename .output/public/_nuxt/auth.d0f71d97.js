import{bW as f,b$ as o,y as g,A as p}from"./entry.893479c5.js";const m=f((v,I)=>{var c,k;const u=o("token"),a=o("remember_token");{const n=localStorage.getItem("accounts")!=="undefined"&&localStorage.getItem("accounts")!==null?(k=(c=JSON.parse(localStorage.getItem("accounts")))==null?void 0:c.map(e=>(Date.parse(e.token_expires)<new Date&&(e.token=null,e.token_expires=null,e.settings_pin_token=null),e)))==null?void 0:k.filter(e=>Date.parse(e.login_pin_token_expires)>new Date||Date.parse(e.token_expires)>new Date):[];if(localStorage.setItem("accounts",JSON.stringify(n)),!u._value&&!a.value){const e=o("first_login"),l=o("settings_pin_token"),i=o("login_pin_token"),s=o("currentAccountID"),t=n.findIndex(r=>r.token);n[t]?(e.value=n[t].firstToken,u.value=n[t].token,l.value=n[t].settings_pin_token,i.value=n[t].login_pin_token,a.value=n[t].remember_token,s.value=0,g("/")):(e.value=null,l.value=null,a.value=null,i.value=null,s.value=null,g("/login"))}else!u._value&&a.value&&p().getRemember(a.value).then(e=>{const l=o("first_login"),i=o("currentAccountID"),s=n.findIndex(_=>_.ID===+i.value),t=new Date;t.setHours(t.getHours()+1);const r=o("token",{expires:t});n[s].token_expires=t,n[s].firstToken=l.value=e.is_first_login,n[s].token=r.value=e.access_token,localStorage.setItem("accounts",JSON.stringify(n))})}});export{m as default};
