import{E as O,_ as q,a as J,b as K}from"./el-overlay.4b93bec8.js";import"./el-button.fb5dead5.js";import{G as Q,s as X,H as Y,r as c,f as N,h as P,w as L,i as d,j as i,k as v,l as u,u as o,m as ss,c as T,p,q as os,o as l,B as b,x as es,y as rs,z as ts}from"./entry.c6755e4d.js";import{_ as B}from"./lock-icon.12f6376f.js";import{_ as ns,a as as}from"./good.88daa3ba.js";import{L as is}from"./LoginButtons.d1f990b8.js";import{E as V}from"./ErrorMassageModal.cd6bb512.js";import{h as I,s as z}from"./eye-close-icon.3601fe2b.js";import{_ as ls}from"./_plugin-vue_export-helper.c27b6911.js";import"./focus-trap.496d67e9.js";import"./chevron-icon.06312b0f.js";const w=h=>(es("data-v-e3ce3c67"),h=h(),rs(),h),ds={class:"main"},us={class:"main__form"},ps=w(()=>i("div",{class:"main__form--title"},"Reset password",-1)),ms=w(()=>i("div",{class:"main__form--subtitle"},"Please fill the forms to reset password",-1)),_s=w(()=>i("img",{src:B,alt:"password_icon"},null,-1)),ws=w(()=>i("span",{for:"password",class:"custom_placeholder"}," Password ",-1)),fs=[ws],cs=["src"],vs={key:0,src:ns,alt:""},gs={key:1,src:as,alt:""},hs={key:2,src:q,alt:""},ys=["innerHTML"],ks={key:0,class:"el-form-item__error"},Ss=["innerHTML"],xs=w(()=>i("div",null,null,-1)),$s=w(()=>i("img",{src:B,alt:"password_icon"},null,-1)),bs=w(()=>i("span",{for:"password_confirmation",class:"custom_placeholder"}," Confirm Password ",-1)),Ms=[bs],Es=["src"],Cs={key:0,class:"el-form-item__error"},Ps=["innerHTML"],Ls=w(()=>i("div",null,null,-1)),Ts={__name:"reset",setup(h){const M=Q(),{resetSuccessData:F,resetErrorData:A,resetLoading:H}=X(M),g=os(),E=Y(),$=c(!1),R=(r,s,a)=>{s||a(new Error("This field is required"));const _=D(s);_==="Weak"?(a(new Error("Password strength: <b>Weak</b>")),e.value.password.status="Weak"):_==="Medium"?(a(),e.value.password.status="Medium",e.value.password.value="Password strength: <b>Medium</b>"):_==="Strong"&&(a(),e.value.password.status="Strong",e.value.password.value="Password strength: <b>Strong</b>")},W=(r,s,a)=>{s===""?a(new Error("Please input the password again")):s!==n.value.password?a(new Error("Password and confirm password do not match")):a()},n=c({password:null,password_confirmation:null,pinToken:null,email:null}),y=c(!1),k=c(!1),Z=c({password:[{validator:R,trigger:"input"}],password_confirmation:[{required:!0,message:"This field is required.",trigger:"blur"},{validator:W,trigger:"blur"}]}),e=c({password:{value:"",status:null,isShow:!1},password_confirmation:{value:"",isShow:!1}});N(()=>{for(n.value.pinToken=E.query.token,n.value.email=E.query.email;P.get("token");)P.remove("token");window.addEventListener("resize",j)});const C=r=>{g.refs[r].focus()},S=r=>{g.refs.resetForm.validateField(r,(s,a)=>{s?r!=="password"&&(e.value[r].value=""):e.value[r].value=a[r][0].message}),Object.values(n.value).every(s=>s)?g.refs.resetForm.validate(s=>$.value=s):$.value=!1},f=(r,s)=>{m()?e.value[r].isShow=s==="mouseover":s==="click"&&(e.value[r].isShow=!0)},j=()=>{g.update()},m=()=>window.innerWidth>990,D=r=>{const s=/^(?=.*[a-zA-Z])(?=.*[\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?])[a-zA-Z\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]{8,}$/,a=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?])[a-zA-Z\d!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]{12,}$/,_=/^(?:(.)(?!\1{3}))*$/,x=["password","admin","qwerty","asdfgh","xzcvb"];if(_.test(r)&&((r==null?void 0:r.length)>15||!x.some(t=>r.toLowerCase().includes(t)))){if(a.test(r)&&((r==null?void 0:r.length)>25||!x.some(t=>r.toLowerCase().includes(t))))return"Strong";if(s.test(r))return"Medium"}return"Weak"},U=()=>{switch(e.value.password.status){case"Medium":return"warning";case"Strong":return"done";default:return""}};L(F,r=>{r&&(n.value.password=null,n.value.password_confirmation=null,ts("/login"))}),L(A,r=>{});const G=()=>{g.refs.resetForm.validate(r=>{if(r)M.resetPassword(n._value);else return e.value.global.value="Please fill empty areas",!1})};return(r,s)=>{const a=J,_=K,x=O;return l(),d("div",ds,[i("div",us,[ps,ms,v(x,{ref:"resetForm",class:"main__form--box","hide-required-asterisk":"",model:o(n),rules:o(Z),onSubmit:ss(G,["prevent"])},{default:u(()=>[v(_,{prop:"password",class:"form-item"},{error:u(()=>[!o(n).password&&o(e).password.isShow&&m()?(l(),d("div",ks,[i("span",{innerHTML:o(e).password.value},null,8,Ss)])):p("",!0),xs]),default:u(()=>[v(a,{ref:"password",modelValue:o(n).password,"onUpdate:modelValue":s[5]||(s[5]=t=>o(n).password=t),class:"main__form--box__input",placeholder:"Password",type:o(y)?"text":"password",onInput:s[6]||(s[6]=t=>S("password")),onBlur:s[7]||(s[7]=t=>S("password"))},{prefix:u(()=>[_s]),suffix:u(()=>[o(n).password?(l(),d("div",{key:0,style:{position:"relative"},onClick:s[0]||(s[0]=t=>C("password"))},fs)):p("",!0),i("img",{class:b(o(e).password.value?"eye_icon":""),src:o(y)?o(I):o(z),alt:"eye_icon",onClick:s[1]||(s[1]=t=>y.value=!o(y))},null,10,cs),o(e).password.value?(l(),d("div",{key:1,class:"error_icon",onMouseover:s[2]||(s[2]=t=>f("password","mouseover")),onMouseout:s[3]||(s[3]=t=>f("password","mouseout")),onClick:s[4]||(s[4]=t=>f("password","click"))},[o(e).password.status==="Medium"&&o(n).password?(l(),d("img",vs)):o(e).password.status==="Strong"&&o(n).password?(l(),d("img",gs)):(l(),d("img",hs))],32)):p("",!0),o(n).password&&o(e).password.isShow&&m()?(l(),d("div",{key:2,class:b([U(),"el-form-item__error strength"])},[i("span",{innerHTML:o(e).password.value},null,8,ys)],2)):p("",!0)]),_:1},8,["modelValue","type"])]),_:1}),v(_,{prop:"password_confirmation",class:"form-item"},{error:u(()=>[o(e).password_confirmation.isShow&&m()?(l(),d("div",Cs,[i("span",{innerHTML:o(e).password_confirmation.value},null,8,Ps)])):p("",!0),Ls]),default:u(()=>[v(a,{ref:"password_confirmation",modelValue:o(n).password_confirmation,"onUpdate:modelValue":s[13]||(s[13]=t=>o(n).password_confirmation=t),class:"main__form--box__input",placeholder:"Confirm password",type:o(k)?"text":"password",onInput:s[14]||(s[14]=t=>S("password_confirmation")),onBlur:s[15]||(s[15]=t=>S("password_confirmation"))},{prefix:u(()=>[$s]),suffix:u(()=>[o(n).password_confirmation?(l(),d("div",{key:0,style:{position:"relative"},onClick:s[8]||(s[8]=t=>C("password_confirmation"))},Ms)):p("",!0),i("img",{class:b(o(e).password_confirmation.value?"eye_icon":""),src:o(k)?o(I):o(z),alt:"eye_icon",onClick:s[9]||(s[9]=t=>k.value=!o(k))},null,10,Es),o(e).password_confirmation.value?(l(),d("img",{key:1,src:q,alt:"",class:"error_icon",onMouseover:s[10]||(s[10]=t=>f("password_confirmation","mouseover")),onMouseout:s[11]||(s[11]=t=>f("password_confirmation","mouseout")),onClick:s[12]||(s[12]=t=>f("password_confirmation","click"))},null,32)):p("",!0)]),_:1},8,["modelValue","type"])]),_:1}),v(is,{"login-title":"Next","is-valid":o($),"show-social":!1,"login-loading":o(H)},null,8,["is-valid","login-loading"])]),_:1},8,["model","rules","onSubmit"])]),o(e).password.isShow&&!m()?(l(),T(V,{key:0,"dialog-visible":o(e).password.isShow&&!m(),"error-text":o(e).password.value,"text-color":o(e).password.status==="Medium"&&o(n).password?"warning":o(e).password.status==="Strong"&&o(n).password?"done":"weak",onVisible:s[16]||(s[16]=t=>o(e).password.isShow=!1)},null,8,["dialog-visible","error-text","text-color"])):p("",!0),o(e).password_confirmation.isShow&&!m()?(l(),T(V,{key:1,"dialog-visible":o(e).password_confirmation.isShow&&!m(),"error-text":o(e).password_confirmation.value,onVisible:s[17]||(s[17]=t=>o(e).password_confirmation.isShow=!1)},null,8,["dialog-visible","error-text"])):p("",!0)])}}},js=ls(Ts,[["__scopeId","data-v-e3ce3c67"]]);export{js as default};
