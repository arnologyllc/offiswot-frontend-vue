import{E as ie}from"./el-input.7fd03793.js";import{E as se,_ as $,a as te}from"./el-overlay.64de5399.js";import{E as ne}from"./el-button.6d07ff3a.js";import"./el-form-item.4ed993c7.js";import{D as re,B as le,s as H,b as ae,r as _,w as h,e as ue,f as d,m as n,u as o,h as v,i as p,j as pe,c as w,k as u,l as me,o as l,t as z,A as F,q as de,x as ve,y as fe,v as _e}from"./entry.1c65c56b.js";import{_ as ce}from"./chevron-left.49d1d463.js";import{E as B}from"./ErrorMassageModal.180b4dfd.js";import{a as ge,_ as we}from"./AccessCheckModal.46cf6b5b.js";import{h as D,s as q}from"./eye-close-icon.f5ebd9e6.js";import be from"./settingsToken.644b8451.js";import ye from"./loginToken.3edc705a.js";import Se from"./auth.3b6594a0.js";import{_ as ke}from"./_plugin-vue_export-helper.c27b6911.js";import"./focus-trap.cf142168.js";import"./refs.6073550b.js";import"./js.cookie.edb2da2a.js";import"./nuxt-storage.min.d80392db.js";import"./_commonjsHelpers.042e6b4d.js";import"./email-primary-icon.754ea29f.js";const f=b=>(ve("data-v-0d959e95"),b=b(),fe(),b),Pe={class:"main"},he={class:"main__form"},$e={class:"main__form--title"},xe=f(()=>n("span",null,"Reset PIN",-1)),Ie=f(()=>n("div",{class:"main__form--subtitle"}," Fill in the fields to change your PIN. ",-1)),Ee={key:0,class:"el-form-item__global-error-container"},Ne={class:"el-form-item__global-error"},Ce=f(()=>n("img",{src:$,alt:""},null,-1)),Ve=f(()=>n("span",{for:"previous",class:"custom_placeholder"}," Old PIN ",-1)),Me=[Ve],Te=["src"],Fe={key:0,class:"el-form-item__error"},Be=["innerHTML"],De=f(()=>n("div",null,null,-1)),qe=f(()=>n("span",{for:"pin",class:"custom_placeholder"}," New PIN ",-1)),Le=[qe],Re=["src"],He={key:0,class:"el-form-item__error"},ze=["innerHTML"],Oe=f(()=>n("div",null,null,-1)),je=f(()=>n("span",{for:"password",class:"custom_placeholder"}," Repeat PIN ",-1)),Ue=[je],We=["src"],Ae={key:0,class:"el-form-item__error"},Xe=["innerHTML"],Ge=f(()=>n("div",null,null,-1)),Je={class:"forgot-password"},Ke={class:"submit-button__text"},Qe={__name:"update-pin",setup(b){const x=re(),O=le(),{resetPinFailureData:j,resetPinData:U,forgotPinFailureData:W,forgotPinData:A,isLoadingSubmit:L}=H(x),{profileSuccessData:I}=H(O),E=me(),X=ae(),G=(i,e,r)=>{e===""?r(new Error("Please input the PIN again")):e!==a.value.pin?r(new Error("PIN and repeat PIN do not match.")):r()},J=(i,e,r)=>{/^\d{4,6}$/.test(e)?r():r(new Error(`<span>PIN is improperly formatted.<br></span>
            <ul class="error_info">
              <li>4-6 characters long.</li>
              <li>Should include only numbers.</li>
            </ul>`))},a=_({previous:null,pin:null,pin_confirmation:null}),y=_(!1),S=_(!1),k=_(!1),c=_(!1),g=_(!1),s=_({previous:{value:"",isShow:!1},pin:{value:"",isShow:!1},pin_confirmation:{value:"",isShow:!1},global:{value:""}}),K=_({previous:[{required:!0,message:"This field is required.",trigger:"blur"}],pin:[{required:!0,message:"This field is required.",trigger:"blur"},{validator:J,trigger:"blur"}],pin_confirmation:[{required:!0,message:"This field is required.",trigger:"blur"},{validator:G,trigger:"blur"}]});h(j,i=>{for(const e in i)if(typeof i[e]!="string")for(const r in i[e])s.value.global.value=i[e][r];else s.value.global.value=i[e]}),h(U,i=>{i&&_e("/")}),h(W,i=>{for(const e in i)if(typeof i[e]!="string")for(const r in i[e])s.value.global.value=i[e][r];else s.value.global.value=i[e]}),h(A,i=>{i&&(c.value=!0)}),ue(()=>{var i,e;Se(),g.value=ye(),g.value=be(),(i=I.value)!=null&&i.user.email&&(a.value.email=(e=I.value)==null?void 0:e.user.email),window.addEventListener("resize",ee())});const Q=()=>{x.resetPin(a.value)},Y=()=>{var i;a.value.email=(i=I.value)==null?void 0:i.user.email,c.value=!0,x.forgotPin()},N=i=>{E.refs.pinForm.validateField(i,(e,r)=>{e?s.value[i].value="":s.value[i].value=r[i][0].message})},Z=()=>{s.value.global.value=""},m=()=>window.innerWidth>990,ee=()=>{E.update()},C=i=>{m()&&(s.value[i].isShow=!1)},V=i=>{s.value[i].isShow=!0},M=i=>{m()&&(s.value[i].isShow=!0)},T=i=>{E.refs[i].focus()};return(i,e)=>{const r=ie,P=te,R=ne,oe=se;return l(),d("div",Pe,[n("div",he,[n("div",$e,[n("img",{src:ce,alt:"chevron-left",onClick:e[0]||(e[0]=t=>o(X).go(-1))}),xe]),Ie,v(oe,{ref:"pinForm",class:"main__form--box","hide-required-asterisk":"",model:o(a),rules:o(K),onSubmit:pe(Q,["prevent"])},{default:p(()=>[o(s).global.value?(l(),d("div",Ee,[n("div",Ne,[Ce,n("span",null,z(o(s).global.value),1)]),n("span",{class:"clear-error",onClick:Z},"X")])):u("",!0),v(P,{prop:"previous",class:"password-form-item"},{error:p(()=>[o(s).previous.isShow&&m()?(l(),d("div",Fe,[n("span",{innerHTML:o(s).previous.value},null,8,Be)])):u("",!0),De]),default:p(()=>[v(r,{id:"previous",ref:"previous",modelValue:o(a).previous,"onUpdate:modelValue":e[6]||(e[6]=t=>o(a).previous=t),type:o(y)?"text":"password",class:"main__form--box__input",placeholder:"Old PIN",onBlur:e[7]||(e[7]=t=>N("previous"))},{suffix:p(()=>[o(a).previous?(l(),d("div",{key:0,style:{position:"relative"},onClick:e[1]||(e[1]=t=>T("previous"))},Me)):u("",!0),n("img",{class:F(o(s).previous.value?"eye_icon":""),src:o(y)?o(D):o(q),alt:"eye_icon",onClick:e[2]||(e[2]=t=>y.value=!o(y))},null,10,Te),o(s).previous.value?(l(),d("img",{key:1,src:$,alt:"",class:"error_icon",onMouseover:e[3]||(e[3]=t=>M("previous")),onMouseout:e[4]||(e[4]=t=>C("previous")),onClick:e[5]||(e[5]=t=>V("previous"))},null,32)):u("",!0)]),_:1},8,["modelValue","type"])]),_:1}),v(P,{prop:"pin",class:"password-form-item"},{error:p(()=>[o(s).pin.isShow&&m()?(l(),d("div",He,[n("span",{innerHTML:o(s).pin.value},null,8,ze)])):u("",!0),Oe]),default:p(()=>[v(r,{id:"pin",ref:"pin",modelValue:o(a).pin,"onUpdate:modelValue":e[13]||(e[13]=t=>o(a).pin=t),type:o(S)?"text":"password",class:"main__form--box__input",placeholder:"New PIN",onBlur:e[14]||(e[14]=t=>N("pin"))},{suffix:p(()=>[o(a).pin?(l(),d("div",{key:0,style:{position:"relative"},onClick:e[8]||(e[8]=t=>T("pin"))},Le)):u("",!0),n("img",{class:F(o(s).pin.value?"eye_icon":""),src:o(S)?o(D):o(q),alt:"eye_icon",onClick:e[9]||(e[9]=t=>S.value=!o(S))},null,10,Re),o(s).pin.value?(l(),d("img",{key:1,src:$,alt:"",class:"error_icon",onMouseover:e[10]||(e[10]=t=>M("pin")),onMouseout:e[11]||(e[11]=t=>C("pin")),onClick:e[12]||(e[12]=t=>V("pin"))},null,32)):u("",!0)]),_:1},8,["modelValue","type"])]),_:1}),v(P,{prop:"pin_confirmation",class:"password-form-item"},{error:p(()=>[o(s).pin_confirmation.isShow&&m()?(l(),d("div",Ae,[n("span",{innerHTML:o(s).pin_confirmation.value},null,8,Xe)])):u("",!0),Ge]),default:p(()=>[v(r,{id:"pin_confirmation",ref:"pin_confirmation",modelValue:o(a).pin_confirmation,"onUpdate:modelValue":e[20]||(e[20]=t=>o(a).pin_confirmation=t),type:o(k)?"text":"password",class:"main__form--box__input",placeholder:"Repeat PIN",onBlur:e[21]||(e[21]=t=>N("pin_confirmation"))},{suffix:p(()=>[o(a).pin_confirmation?(l(),d("div",{key:0,style:{position:"relative"},onClick:e[15]||(e[15]=t=>T("pin_confirmation"))},Ue)):u("",!0),n("img",{class:F(o(s).pin_confirmation.value?"eye_icon":""),src:o(k)?o(D):o(q),alt:"eye_icon",onClick:e[16]||(e[16]=t=>k.value=!o(k))},null,10,We),o(s).pin_confirmation.value?(l(),d("img",{key:1,src:$,alt:"",class:"error_icon",onMouseover:e[17]||(e[17]=t=>M("pin_confirmation")),onMouseout:e[18]||(e[18]=t=>C("pin_confirmation")),onClick:e[19]||(e[19]=t=>V("pin_confirmation"))},null,32)):u("",!0)]),_:1},8,["modelValue","type"])]),_:1}),n("div",Je,[v(R,{style:{"font-size":"14px","font-weight":"400"},onClick:Y},{default:p(()=>[de("Forgot PIN?")]),_:1})]),v(R,{class:"submit-button","native-type":"submit",loading:o(L)},{default:p(()=>[n("span",Ke,z(o(L)?"":"Save"),1)]),_:1},8,["loading"]),o(s).previous.isShow&&!m()?(l(),w(B,{key:1,"dialog-visible":o(s).previous.isShow&&!m(),"error-text":o(s).previous.value,onVisible:e[22]||(e[22]=t=>o(s).previous.isShow=!1)},null,8,["dialog-visible","error-text"])):u("",!0),o(s).pin.isShow&&!m()?(l(),w(B,{key:2,"dialog-visible":o(s).pin.isShow&&!m(),"error-text":o(s).pin.value,onVisible:e[23]||(e[23]=t=>o(s).pin.isShow=!1)},null,8,["dialog-visible","error-text"])):u("",!0),o(s).pin_confirmation.isShow&&!m()?(l(),w(B,{key:3,"dialog-visible":o(s).pin_confirmation.isShow&&!m(),"error-text":o(s).pin_confirmation.value,onVisible:e[24]||(e[24]=t=>o(s).pin_confirmation.isShow=!1)},null,8,["dialog-visible","error-text"])):u("",!0)]),_:1},8,["model","rules","onSubmit"])]),o(c)?(l(),w(ge,{key:0,email:o(a).email,"dialog-visible":o(c),onClose:e[25]||(e[25]=t=>c.value=!1)},null,8,["email","dialog-visible"])):u("",!0),o(g)?(l(),w(we,{key:1,"dialog-visible":o(g),onClose:e[26]||(e[26]=t=>g.value=!1)},null,8,["dialog-visible"])):u("",!0)])}}},wo=ke(Qe,[["__scopeId","data-v-0d959e95"]]);export{wo as default};
