import{b as A,D as b,G as y,a as $,r as p,f as x,E as C,i as l,j as o,F as N,v as O,u as B,p as v,c as J,h as s,o as c,t as P,x as T,y as U,A as E,z as d}from"./entry.571ec35c.js";import{_ as V}from"./chevron-left.c4b12ffc.js";import j from"./settingsToken.1eb8f680.js";import F from"./loginToken.efedc108.js";import L from"./auth.8069d5ea.js";import{_ as W}from"./AccessCheckModal.25272e00.js";import{_ as z}from"./_plugin-vue_export-helper.c27b6911.js";import"./el-overlay.44d2d524.js";import"./el-button.932f9628.js";import"./focus-trap.4e138211.js";import"./email-primary-icon.61d97e74.js";import"./eye-close-icon.92fea8ee.js";const G=""+new URL("clock.e3f6f434.svg",import.meta.url).href;const _=r=>(T("data-v-623bde4a"),r=r(),U(),r),M={class:"main"},R={class:"main__form"},Y={class:"main__form--title"},q=_(()=>o("span",null,"Choose account to continue with",-1)),D=_(()=>o("div",{class:"main__form--subtitle"},"You can manage different accounts from one place",-1)),H={class:"main__users"},K={key:0,class:"main__top"},Q=["onClick"],X=["src"],Z={class:"main__user-actions--info"},I={class:"main__user-actions--info__email"},ee=_(()=>o("span",{class:"main__user-actions--info__time"},[o("img",{src:G,alt:"clock",class:"main__user-actions--info__clock"}),E(" Just now ")],-1)),te=_(()=>o("div",{class:"main__user-actions--add"},[o("span",null,"+"),o("span",{class:"main__user-actions--add__title"},"Add new account")],-1)),oe=[te],se={__name:"choose-account",setup(r){L();const u=A(),f=b(),g=y(),k=$(),t=p(!1),i=p(!1),h=p(null);x(()=>{i.value=F(),i.value=j(),t.value=JSON.parse(localStorage.getItem("accounts")).filter(e=>e.token)});const S=C(()=>t.value.reduce((e,a)=>(a.token&&e.push(a),e),[])),w=()=>{s.set("currentAccountID",t.value.length),s.set("addAccount",!0),window.open("/login","_blank")},m=async e=>{if(h.value=e,s.set("currentAccountID",e),t.value[e].token===s.get("token")){d("/create-workspace");return}if(u.$reset(),f.$reset(),g.$reset(),k.$reset(),(Date.parse(t.value[e].token_expires)-Date.now())/864e5<0){t.value.splice(e,1),localStorage.setItem("accounts",JSON.stringify(t.value)),t.value[0]?m(0):(Object.keys(s.get()).forEach(function(a){s.remove(a,neededAttributes)}),$router.go());return}s.set("token",t.value[e].token,{expires:(Date.parse(t.value[e].token_expires)-Date.now())/864e5}),s.set("remember_token",t.value[e].remember_token),s.set("first_login",t.value[e].first_login),t.value[e].settings_pin_token&&s.set("settings_pin_token",t.value[e].settings_pin_token),t.value[e].login_pin_token&&s.set("login_pin_token",t.value[e].login_pin_token,{expires:(Date.parse(t.value[e].login_pin_token_expires)-new Date)/864e5}),localStorage.setItem("accounts",JSON.stringify(t.value)),t.value[e].first_login===!0&&d("/pin"),u.getProfile(),await u.getWorkSpaces(),d("/create-workspace")};return(e,a)=>(c(),l("div",M,[o("div",R,[o("div",Y,[o("img",{src:V,alt:"chevron-left",onClick:a[0]||(a[0]=n=>e.$router.go(-1))}),q]),D]),o("div",H,[t.value?(c(),l("div",K,[(c(!0),l(N,null,O(B(S),n=>(c(),l("div",{key:n.ID,class:"main__user-actions",onClick:ae=>m(n.ID)},[o("img",{src:n.avatarUrl?n.avatarUrl:e.defaultAvatar,alt:"Avatar",class:"main__user-actions--avatar"},null,8,X),o("div",Z,[o("span",I,P(n.email),1),ee])],8,Q))),128))])):v("",!0),o("div",{class:"main__user-actions",onClick:w},oe)]),i.value?(c(),J(W,{key:0,"dialog-visible":i.value,onClose:a[1]||(a[1]=n=>i.value=!1)},null,8,["dialog-visible"])):v("",!0)]))}},ge=z(se,[["__scopeId","data-v-623bde4a"]]);export{ge as default};
