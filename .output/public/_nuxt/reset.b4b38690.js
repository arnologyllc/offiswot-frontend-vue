import{E as G}from"./focus-trap.04464a06.js";import{_ as S,E as J,a as K}from"./error.3564d58a.js";import{E as O}from"./index.9ce43428.js";import{D as Q,s as X,b as Y,e as Z,f as ee,r as c,w as N,h as oe,o as a,i as m,l as s,j as f,k as d,u as o,t as V,m as u,C as M,c as T,v as ne,x as ie,y as te,z as se}from"./entry.dabfc507.js";import{E as q}from"./ErrorMassageModal.8c97b422.js";import{h as F,s as R}from"./eye-close-icon.eaa88d21.js";import re from"./auth.0edab5ad.js";import{_ as le}from"./_plugin-vue_export-helper.c27b6911.js";const _=v=>(te("data-v-30fdd884"),v=v(),se(),v),ae={class:"main"},ue={class:"main__form"},pe=_(()=>s("div",{class:"main__form--title"},"Reset PIN",-1)),me=_(()=>s("div",{class:"main__form--subtitle"}," Enter a new PIN below to change your PIN. ",-1)),de={key:0,class:"el-form-item__global-error"},_e=_(()=>s("img",{src:S,alt:""},null,-1)),fe=_(()=>s("span",{for:"pin",class:"pin_placeholder"}," PIN ",-1)),ce=[fe],ve=["src"],ge={key:0,class:"el-form-item__error"},we=["innerHTML"],ye=_(()=>s("div",null,null,-1)),he=_(()=>s("span",{for:"password",class:"repeat-placeholder"}," PIN Confirmation ",-1)),be=[he],Se=["src"],Ie={key:0,class:"el-form-item__error"},ke=["innerHTML"],Ee=_(()=>s("div",null,null,-1)),Pe={class:"submit-button__text"},xe={__name:"reset",setup(v){const I=Q(),{changePinData:B,changePinFailureData:L,isLoadingSubmit:k}=X(I),g=Y(),w=Z();ee();const z=(i,e,r)=>{e===""?r(new Error("Please input the PIN again")):e!==l.value.pin?r(new Error("PIN and repeat PIN do not match.")):r()},D=(i,e,r)=>{/^\d{4,6}$/.test(e)?r():r(new Error(`<span>PIN is improperly formatted.<br></span>
            <ul class="error_info">
              <li>4-6 characters long.</li>
              <li>Should include only numbers.</li>
            </ul>`))},l=c({pin:null,pin_confirmation:null,pinToken:null}),n=c({pin:{value:"",isShow:!1},pin_confirmation:{value:"",isShow:!1},global:{value:""}}),H=c({pin:[{required:!0,message:"This field is required.",trigger:"blur"},{validator:D,trigger:"blur"}],pin_confirmation:[{required:!0,message:"This field is required.",trigger:"blur"},{validator:z,trigger:"blur"}]}),y=c(!1),h=c(!1);N(L,i=>{for(const e in i)if(typeof i[e]!="string")for(const r in i[e])n.value.global.value=i[e][r];else n.value.global.value=i[e]}),N(B,i=>{l.value={pin:null,pin_confirmation:null},ie("/")}),oe(()=>{re(),w.query.email&&(l.value.email=w.query.email),w.query.token&&(l.value.pinToken=w.query.token),window.addEventListener("resize",U)});const j=()=>{g.refs.resetForm.validate(i=>{if(i)I.changePin(l.value);else return n.value.global.value="Please fill empty areas",!1})},E=i=>{g.refs.resetForm.validateField(i,(e,r)=>{e?n.value[i].value="":n.value[i].value=r[i][0].message})},p=()=>window.innerWidth>990,U=()=>{g.update()},P=i=>{p()&&(n.value[i].isShow=!1)},x=i=>{n.value[i].isShow=!0},$=i=>{p()&&(n.value[i].isShow=!0)},C=i=>{g.refs[i].focus()};return(i,e)=>{const r=G,b=J,W=O,A=K;return a(),m("div",ae,[s("div",ue,[pe,me,f(A,{ref:"resetForm",class:"main__form--box","hide-required-asterisk":"",model:o(l),rules:o(H),onSubmit:ne(j,["prevent"])},{default:d(()=>[o(n).global.value?(a(),m("div",de,[_e,s("span",null,V(o(n).global.value),1)])):u("",!0),f(b,{prop:"pin",class:"password-form-item"},{error:d(()=>[o(n).pin.isShow&&p()?(a(),m("div",ge,[s("span",{innerHTML:o(n).pin.value},null,8,we)])):u("",!0),ye]),default:d(()=>[f(r,{id:"pin",ref:"pin",modelValue:o(l).pin,"onUpdate:modelValue":e[5]||(e[5]=t=>o(l).pin=t),type:o(y)?"text":"password",class:"main__form--box__input",placeholder:"Enter PIN",onChange:e[6]||(e[6]=t=>E("pin"))},{suffix:d(()=>[o(l).pin?(a(),m("div",{key:0,style:{position:"relative"},onClick:e[0]||(e[0]=t=>C("pin"))},ce)):u("",!0),s("img",{class:M(o(n).pin.value?"eye_icon":""),src:o(y)?o(F):o(R),alt:"eye_icon",onClick:e[1]||(e[1]=t=>y.value=!o(y))},null,10,ve),o(n).pin.value?(a(),m("img",{key:1,src:S,alt:"",class:"error_icon",onMouseover:e[2]||(e[2]=t=>$("pin")),onMouseout:e[3]||(e[3]=t=>P("pin")),onClick:e[4]||(e[4]=t=>x("pin"))},null,32)):u("",!0)]),_:1},8,["modelValue","type"])]),_:1}),f(b,{prop:"pin_confirmation",class:"password-form-item"},{error:d(()=>[o(n).pin_confirmation.isShow&&p()?(a(),m("div",Ie,[s("span",{innerHTML:o(n).pin_confirmation.value},null,8,ke)])):u("",!0),Ee]),default:d(()=>[f(r,{id:"pin_confirmation",ref:"pin_confirmation",modelValue:o(l).pin_confirmation,"onUpdate:modelValue":e[12]||(e[12]=t=>o(l).pin_confirmation=t),type:o(h)?"text":"password",class:"main__form--box__input",placeholder:"Repeat PIN",onBlur:e[13]||(e[13]=t=>E("pin_confirmation"))},{suffix:d(()=>[o(l).pin_confirmation?(a(),m("div",{key:0,style:{position:"relative"},onClick:e[7]||(e[7]=t=>C("pin_confirmation"))},be)):u("",!0),s("img",{class:M(o(n).pin_confirmation.value?"eye_icon":""),src:o(h)?o(F):o(R),alt:"eye_icon",onClick:e[8]||(e[8]=t=>h.value=!o(h))},null,10,Se),o(n).pin_confirmation.value?(a(),m("img",{key:1,src:S,alt:"",class:"error_icon",onMouseover:e[9]||(e[9]=t=>$("pin_confirmation")),onMouseout:e[10]||(e[10]=t=>P("pin_confirmation")),onClick:e[11]||(e[11]=t=>x("pin_confirmation"))},null,32)):u("",!0)]),_:1},8,["modelValue","type"])]),_:1}),f(W,{class:"submit-button","native-type":"submit",loading:o(k)},{default:d(()=>[s("span",Pe,V(o(k)?"":"Save"),1)]),_:1},8,["loading"]),o(n).pin.isShow&&!p()?(a(),T(q,{key:1,dialogVisible:o(n).pin.isShow&&!p(),"error-text":o(n).pin.value,onVisible:e[14]||(e[14]=t=>o(n).pin.isShow=!1)},null,8,["dialogVisible","error-text"])):u("",!0),o(n).pin_confirmation.isShow&&!p()?(a(),T(q,{key:2,dialogVisible:o(n).pin_confirmation.isShow&&!p(),"error-text":o(n).pin_confirmation.value,onVisible:e[15]||(e[15]=t=>o(n).pin_confirmation.isShow=!1)},null,8,["dialogVisible","error-text"])):u("",!0)]),_:1},8,["model","rules","onSubmit"])])])}}},Re=le(xe,[["__scopeId","data-v-30fdd884"]]);export{Re as default};
