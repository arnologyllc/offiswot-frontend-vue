import{E as G,_ as h,a as Y,b as K}from"./el-overlay.cc8d7c8f.js";import{E as Q}from"./el-button.efbddc4b.js";import"./el-form-item.4ed993c7.js";import{r as f,A as X,z as Z,s as ee,H as oe,w as $,e as ie,f as m,m as r,h as c,i as _,u as o,j as ne,l as te,o as a,t as se,k as u,E as C,c as M,v as re,x as le,G as V,q as T}from"./entry.d5ce8ebf.js";import{E as F}from"./ErrorMassageModal.4b7d9029.js";import{h as B,s as q}from"./eye-close-icon.225f2d95.js";import ae from"./auth.a45746ca.js";import{_ as ue}from"./_plugin-vue_export-helper.c27b6911.js";import"./focus-trap.2184c8ed.js";const d=g=>(re("data-v-39802450"),g=g(),le(),g),pe={class:"main"},me={class:"main__form"},_e=d(()=>r("div",{class:"main__form--title"},"Set PIN",-1)),de=d(()=>r("div",{class:"main__form--subtitle"},"Fill in the fields to set your PIN.",-1)),fe={key:0,class:"el-form-item__global-error-container"},ce={class:"el-form-item__global-error"},ve=d(()=>r("img",{src:h,alt:""},null,-1)),ge=d(()=>r("span",{for:"pin",class:"custom_placeholder"}," PIN ",-1)),Se=[ge],we=["src"],be={key:0,class:"el-form-item__error"},ye=["innerHTML"],he=d(()=>r("div",null,null,-1)),Ie=d(()=>r("span",{for:"password",class:"custom_placeholder"}," PIN Confirmation ",-1)),xe=[Ie],Ee=["src"],Pe={key:0,class:"el-form-item__error"},ke=["innerHTML"],Ne=d(()=>r("div",null,null,-1)),$e=d(()=>r("span",{class:"submit-button__text"},"Save",-1)),Ce={__name:"index",setup(g){const v=f(!1),I=X(),L=Z(),{setPinData:D,setPinFailureData:H,isLoadingSubmit:R}=ee(I),b=te();oe();const z=(n,e,s)=>{e===""?s(new Error("Please input the PIN again")):e!==l.value.pin?s(new Error("PIN and repeat PIN do not match.")):s()},J=(n,e,s)=>{/^\d{4,6}$/.test(e)?s():s(new Error(`<span>PIN is improperly formatted.<br></span>
            <ul class="error_info">
              <li>4-6 characters long.</li>
              <li>Should include only numbers.</li>
            </ul>`))},l=f({pin:null,pin_confirmation:null}),i=f({pin:{value:"",isShow:!1},pin_confirmation:{value:"",isShow:!1},global:{value:""}}),O=f({pin:[{required:!0,message:"This field is required.",trigger:"blur"},{validator:J,trigger:"blur"}],pin_confirmation:[{required:!0,message:"This field is required.",trigger:"blur"},{validator:z,trigger:"blur"}]}),S=f(!1),w=f(!1);$(H,n=>{for(const e in n)if(typeof n[e]!="string")for(const s in n[e])i.value.global.value=n[e][s];else i.value.global.value=n[e];i.value.global.value==="You have already created a pin."&&setTimeout(()=>{v.value[0].first_login=!1,localStorage.setItem("accounts",JSON.stringify(v.value)),V.remove("first_login"),T("/")},2e3)}),$(D,n=>{v.value[0].first_login=null,localStorage.setItem("accounts",JSON.stringify(v.value)),V.remove("first_login"),T("/")}),ie(()=>{var n,e,s;ae(),v.value=JSON.parse(localStorage.getItem("accounts")),(e=(n=L.profileSuccessData)==null?void 0:n.value)!=null&&e.user.email&&(l.value.email=(s=profileSuccessData==null?void 0:profileSuccessData.value)==null?void 0:s.user.email),window.addEventListener("resize",U)});const j=()=>{I.setPin(l.value)},x=n=>{b.refs.pinForm.validateField(n,(e,s)=>{e?i.value[n].value="":i.value[n].value=s[n][0].message})},p=()=>window.innerWidth>990,U=()=>{b.update()},E=n=>{p()&&(i.value[n].isShow=!1)},P=n=>{i.value[n].isShow=!0},k=n=>{p()&&(i.value[n].isShow=!0)},N=n=>{b.refs[n].focus()};return(n,e)=>{const s=Y,y=K,W=Q,A=G;return a(),m("div",pe,[r("div",me,[_e,de,c(A,{ref:"pinForm",class:"main__form--box","hide-required-asterisk":"",model:o(l),rules:o(O),onSubmit:ne(j,["prevent"])},{default:_(()=>[o(i).global.value?(a(),m("div",fe,[r("div",ce,[ve,r("span",null,se(o(i).global.value),1)])])):u("",!0),c(y,{prop:"pin",class:"password-form-item"},{error:_(()=>[o(i).pin.isShow&&p()?(a(),m("div",be,[r("span",{innerHTML:o(i).pin.value},null,8,ye)])):u("",!0),he]),default:_(()=>[c(s,{id:"pin",ref:"pin",modelValue:o(l).pin,"onUpdate:modelValue":e[5]||(e[5]=t=>o(l).pin=t),type:o(S)?"text":"password",class:"main__form--box__input",placeholder:"Enter PIN",onBlur:e[6]||(e[6]=t=>x("pin"))},{suffix:_(()=>[o(l).pin?(a(),m("div",{key:0,style:{position:"relative"},onClick:e[0]||(e[0]=t=>N("pin"))},Se)):u("",!0),r("img",{class:C(o(i).pin.value?"eye_icon":""),src:o(S)?o(B):o(q),alt:"eye_icon",onClick:e[1]||(e[1]=t=>S.value=!o(S))},null,10,we),o(i).pin.value?(a(),m("img",{key:1,src:h,alt:"",class:"error_icon",onMouseover:e[2]||(e[2]=t=>k("pin")),onMouseout:e[3]||(e[3]=t=>E("pin")),onClick:e[4]||(e[4]=t=>P("pin"))},null,32)):u("",!0)]),_:1},8,["modelValue","type"])]),_:1}),c(y,{prop:"pin_confirmation",class:"password-form-item"},{error:_(()=>[o(i).pin_confirmation.isShow&&p()?(a(),m("div",Pe,[r("span",{innerHTML:o(i).pin_confirmation.value},null,8,ke)])):u("",!0),Ne]),default:_(()=>[c(s,{id:"pin_confirmation",ref:"pin_confirmation",modelValue:o(l).pin_confirmation,"onUpdate:modelValue":e[12]||(e[12]=t=>o(l).pin_confirmation=t),type:o(w)?"text":"password",class:"main__form--box__input",placeholder:"Repeat PIN",onBlur:e[13]||(e[13]=t=>x("pin_confirmation"))},{suffix:_(()=>[o(l).pin_confirmation?(a(),m("div",{key:0,style:{position:"relative"},onClick:e[7]||(e[7]=t=>N("pin_confirmation"))},xe)):u("",!0),r("img",{class:C(o(i).pin_confirmation.value?"eye_icon":""),src:o(w)?o(B):o(q),alt:"eye_icon",onClick:e[8]||(e[8]=t=>w.value=!o(w))},null,10,Ee),o(i).pin_confirmation.value?(a(),m("img",{key:1,src:h,alt:"",class:"error_icon",onMouseover:e[9]||(e[9]=t=>k("pin_confirmation")),onMouseout:e[10]||(e[10]=t=>E("pin_confirmation")),onClick:e[11]||(e[11]=t=>P("pin_confirmation"))},null,32)):u("",!0)]),_:1},8,["modelValue","type"])]),_:1}),c(W,{class:"submit-button","native-type":"submit",loading:o(R)},{default:_(()=>[$e]),_:1},8,["loading"]),o(i).pin.isShow&&!p()?(a(),M(F,{key:1,"dialog-visible":o(i).pin.isShow&&!p(),"error-text":o(i).pin.value,onVisible:e[14]||(e[14]=t=>o(i).pin.isShow=!1)},null,8,["dialog-visible","error-text"])):u("",!0),o(i).pin_confirmation.isShow&&!p()?(a(),M(F,{key:2,"dialog-visible":o(i).pin_confirmation.isShow&&!p(),"error-text":o(i).pin_confirmation.value,onVisible:e[15]||(e[15]=t=>o(i).pin_confirmation.isShow=!1)},null,8,["dialog-visible","error-text"])):u("",!0)]),_:1},8,["model","rules","onSubmit"])])])}}},Re=ue(Ce,[["__scopeId","data-v-39802450"]]);export{Re as default};
