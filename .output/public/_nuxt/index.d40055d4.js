import{E as U,_ as I,a as W,b as G}from"./el-overlay.6ca4e62b.js";import{E as Y}from"./el-button.e243c5d4.js";import"./el-form-item.4ed993c7.js";import{r as f,B as K,A as Q,s as X,H as Z,w as E,e as ee,h as p,p as r,i as v,j as m,u as o,k as oe,m as ie,o as a,t as ne,l as u,G as N,c as $,x as te,y as se,f as C,v as M}from"./entry.a509592d.js";import{E as V}from"./ErrorMassageModal.1c89c491.js";import{h as T,s as B}from"./eye-close-icon.545039e0.js";import re from"./auth.8c39c358.js";import{_ as le}from"./_plugin-vue_export-helper.c27b6911.js";import"./focus-trap.14e866f0.js";const _=b=>(te("data-v-b44e6846"),b=b(),se(),b),ae={class:"main"},ue={class:"main__form"},pe=_(()=>r("div",{class:"main__form--title"},"Set PIN",-1)),me=_(()=>r("div",{class:"main__form--subtitle"},"Fill in the fields to set your PIN.",-1)),_e={key:0,class:"el-form-item__global-error-container"},de={class:"el-form-item__global-error"},ce=_(()=>r("img",{src:I,alt:""},null,-1)),fe=_(()=>r("span",{for:"pin",class:"custom_placeholder"}," PIN ",-1)),ve=[fe],ge=["src"],be={key:0,class:"el-form-item__error"},we=["innerHTML"],Se=_(()=>r("div",null,null,-1)),ye=_(()=>r("span",{for:"password",class:"custom_placeholder"}," PIN Confirmation ",-1)),he=[ye],Ie=["src"],xe={key:0,class:"el-form-item__error"},ke=["innerHTML"],Pe=_(()=>r("div",null,null,-1)),Ee=_(()=>r("span",{class:"submit-button__text"},"Save",-1)),Ne={__name:"index",setup(b){const g=f(!1),x=K(),F=Q(),{setPinData:L,setPinFailureData:q,isLoadingSubmit:D}=X(x),y=ie();Z();const H=(n,e,t)=>{e===""?t(new Error("Please input the PIN again")):e!==l.value.pin?t(new Error("PIN and repeat PIN do not match.")):t()},R=(n,e,t)=>{/^\d{4,6}$/.test(e)?t():t(new Error(`<span>PIN is improperly formatted.<br></span>
            <ul class="error_info">
              <li>4-6 characters long.</li>
              <li>Should include only numbers.</li>
            </ul>`))},l=f({pin:null,pin_confirmation:null}),i=f({pin:{value:"",isShow:!1},pin_confirmation:{value:"",isShow:!1},global:{value:""}}),z=f({pin:[{required:!0,message:"This field is required.",trigger:"blur"},{validator:R,trigger:"blur"}],pin_confirmation:[{required:!0,message:"This field is required.",trigger:"blur"},{validator:H,trigger:"blur"}]}),w=f(!1),S=f(!1);E(q,n=>{for(const e in n)if(typeof n[e]!="string")for(const t in n[e])i.value.global.value=n[e][t];else i.value.global.value=n[e];i.value.global.value==="You have already created a pin."&&setTimeout(()=>{g.value[0].first_login=!1,localStorage.setItem("accounts",JSON.stringify(g.value)),C.remove("first_login"),M("/")},2e3)}),E(L,n=>{g.value[0].first_login=null,localStorage.setItem("accounts",JSON.stringify(g.value)),C.remove("first_login"),M("/")}),ee(()=>{var n,e,t;re(),g.value=JSON.parse(localStorage.getItem("accounts")),(e=(n=F.profileSuccessData)==null?void 0:n.value)!=null&&e.user.email&&(l.value.email=(t=profileSuccessData==null?void 0:profileSuccessData.value)==null?void 0:t.user.email),window.addEventListener("resize",J)});const A=()=>{x.setPin(l.value)},k=n=>{y.refs.pinForm.validateField(n,(e,t)=>{e?i.value[n].value="":i.value[n].value=t[n][0].message})},d=()=>window.innerWidth>990,J=()=>{y.update()},c=(n,e)=>{d()?i.value[n].isShow=e==="mouseover":e==="click"&&(i.value[n].isShow=!0)},P=n=>{y.refs[n].focus()};return(n,e)=>{const t=W,h=G,O=Y,j=U;return a(),p("div",ae,[r("div",ue,[pe,me,v(j,{ref:"pinForm",class:"main__form--box","hide-required-asterisk":"",model:o(l),rules:o(z),onSubmit:oe(A,["prevent"])},{default:m(()=>[o(i).global.value?(a(),p("div",_e,[r("div",de,[ce,r("span",null,ne(o(i).global.value),1)])])):u("",!0),v(h,{prop:"pin",class:"password-form-item"},{error:m(()=>[o(i).pin.isShow&&d()?(a(),p("div",be,[r("span",{innerHTML:o(i).pin.value},null,8,we)])):u("",!0),Se]),default:m(()=>[v(t,{id:"pin",ref:"pin",modelValue:o(l).pin,"onUpdate:modelValue":e[5]||(e[5]=s=>o(l).pin=s),type:o(w)?"text":"password",class:"main__form--box__input",placeholder:"Enter PIN",onBlur:e[6]||(e[6]=s=>k("pin"))},{suffix:m(()=>[o(l).pin?(a(),p("div",{key:0,style:{position:"relative"},onClick:e[0]||(e[0]=s=>P("pin"))},ve)):u("",!0),r("img",{class:N(o(i).pin.value?"eye_icon":""),src:o(w)?o(T):o(B),alt:"eye_icon",onClick:e[1]||(e[1]=s=>w.value=!o(w))},null,10,ge),o(i).pin.value?(a(),p("img",{key:1,src:I,alt:"",class:"error_icon",onMouseover:e[2]||(e[2]=s=>c("pin","mouseover")),onMouseout:e[3]||(e[3]=s=>c("pin","mouseout")),onClick:e[4]||(e[4]=s=>c("pin","click"))},null,32)):u("",!0)]),_:1},8,["modelValue","type"])]),_:1}),v(h,{prop:"pin_confirmation",class:"password-form-item"},{error:m(()=>[o(i).pin_confirmation.isShow&&d()?(a(),p("div",xe,[r("span",{innerHTML:o(i).pin_confirmation.value},null,8,ke)])):u("",!0),Pe]),default:m(()=>[v(t,{id:"pin_confirmation",ref:"pin_confirmation",modelValue:o(l).pin_confirmation,"onUpdate:modelValue":e[12]||(e[12]=s=>o(l).pin_confirmation=s),type:o(S)?"text":"password",class:"main__form--box__input",placeholder:"Repeat PIN",onBlur:e[13]||(e[13]=s=>k("pin_confirmation"))},{suffix:m(()=>[o(l).pin_confirmation?(a(),p("div",{key:0,style:{position:"relative"},onClick:e[7]||(e[7]=s=>P("pin_confirmation"))},he)):u("",!0),r("img",{class:N(o(i).pin_confirmation.value?"eye_icon":""),src:o(S)?o(T):o(B),alt:"eye_icon",onClick:e[8]||(e[8]=s=>S.value=!o(S))},null,10,Ie),o(i).pin_confirmation.value?(a(),p("img",{key:1,src:I,alt:"",class:"error_icon",onMouseover:e[9]||(e[9]=s=>c("pin_confirmation","mouseover")),onMouseout:e[10]||(e[10]=s=>c("pin_confirmation","mouseout")),onClick:e[11]||(e[11]=s=>c("pin_confirmation","click"))},null,32)):u("",!0)]),_:1},8,["modelValue","type"])]),_:1}),v(O,{class:"submit-button","native-type":"submit",loading:o(D)},{default:m(()=>[Ee]),_:1},8,["loading"]),o(i).pin.isShow&&!d()?(a(),$(V,{key:1,"dialog-visible":o(i).pin.isShow&&!d(),"error-text":o(i).pin.value,onVisible:e[14]||(e[14]=s=>o(i).pin.isShow=!1)},null,8,["dialog-visible","error-text"])):u("",!0),o(i).pin_confirmation.isShow&&!d()?(a(),$(V,{key:2,"dialog-visible":o(i).pin_confirmation.isShow&&!d(),"error-text":o(i).pin_confirmation.value,onVisible:e[15]||(e[15]=s=>o(i).pin_confirmation.isShow=!1)},null,8,["dialog-visible","error-text"])):u("",!0)]),_:1},8,["model","rules","onSubmit"])])])}}},De=le(Ne,[["__scopeId","data-v-b44e6846"]]);export{De as default};
