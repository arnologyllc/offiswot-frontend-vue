import{c as A,_ as Y,a as K,b as Q,E as Z}from"./el-overlay.cc8d7c8f.js";import{E as ee}from"./el-button.efbddc4b.js";import"./el-form-item.4ed993c7.js";import{A as M,s as F,r,w as y,e as R,o as d,c as B,i as u,m as o,u as s,f as w,t as D,k as g,j as z,z as te,H as oe,b as se,h as P,y as le,G as k,l as ae}from"./entry.d5ce8ebf.js";import{_ as ie}from"./email-primary-icon.83ef1c2c.js";import{h as ne,s as re}from"./eye-close-icon.225f2d95.js";const ue=""+new URL("access-check.4d7962db.svg",import.meta.url).href,ce=o("div",null,[o("div",{class:"title__image"},[o("img",{src:ie,alt:""})]),o("div",{class:"title__text"},"Check your email")],-1),de=o("span",{class:"title"},"In order to reset your PIN check your email and follow the instructions.",-1),pe={key:0,class:"error"},me={class:"dialog-footer"},_e={key:0},ge=["onClick"],fe={key:2,class:"later"},ve={__name:"OvConfirmPINChangeModal",props:{dialogVisible:{type:Boolean,required:!1},email:{type:String,default:""},appendToBody:{type:Boolean,default:!1}},setup(E){const f=E,I=M(),{forgotPinData:v,forgotPinFailureData:C}=F(I),a=r("560px"),i=r(59),c=r(null);y(v,p=>{});const x=()=>{i._value=59,I.forgotPin({email:f.email})};return y(C,p=>{p&&(c.value="You have exceeded the maximum number of reset PIN requests.")}),R(()=>{document.documentElement.clientWidth<=425&&(a.value="315px"),window.addEventListener("resize",p=>{p.target.innerWidth<=425?a.value="315px":a.value="560px"}),setInterval(()=>{i.value&&i.value--},1e3)}),(p,h)=>{const N=A;return d(),B(N,{modelValue:f.dialogVisible,"onUpdate:modelValue":h[0]||(h[0]=$=>f.dialogVisible=$),width:s(a),"append-to-body":E.appendToBody,"show-close":"",top:"30vh",class:"customModal",onClose:h[1]||(h[1]=$=>p.$emit("close"))},{header:u(()=>[ce]),footer:u(()=>[o("span",me,[s(i)&&!s(c)?(d(),w("span",_e,"0:"+D(s(i)>9?s(i):`0${s(i)}`),1)):g("",!0),!s(c)&&!s(i)?(d(),w("a",{key:1,href:"",class:"dialog-footer__action",onClick:z(x,["prevent"])},"Resend Email",8,ge)):g("",!0),s(c)?(d(),w("span",fe," Please try again later. ")):g("",!0)])]),default:u(()=>[de,s(c)?(d(),w("span",pe,D(s(c)),1)):g("",!0)]),_:1},8,["modelValue","width","append-to-body"])}}},he=o("div",{class:"access-header"},[o("h3",null,"Access check")],-1),be=o("div",{class:"title__image"},[o("img",{src:ue,alt:""})],-1),ke=o("span",{class:"title__text"}," Please enter your PIN in order to access account management section. ",-1),ye={key:0,class:"el-form-item__global-error-container"},we={class:"el-form-item__global-error"},xe=o("img",{src:Y,alt:""},null,-1),Pe=o("span",{for:"pin",class:"custom_placeholder"}," Enter PIN ",-1),Ee=[Pe],Ie=["src"],$e={class:"forgot-password"},Ve={class:"submit-button__text"},Te={__name:"AccessCheckModal",props:{dialogVisible:{type:Boolean,required:!1}},setup(E){const f=E,I=te(),v=r("450px"),C=r("400px"),a=ae(),i=oe(),c=se(),x=M(),{checkPinData:p,checkPinFailureData:h,forgotPinData:N,forgotPinFailureData:$,isLoadingSubmit:T}=F(x),{profileSuccessData:q}=F(I),m=r({pin:null}),L=r({pin:[{required:!0,message:"This field is required.",trigger:"blur"},{min:4,max:6,message:"PIN must be between 4 and 6 digits",trigger:"blur"}]}),n=r({pin:{value:"",isShow:!1},global:{value:null}}),V=r(!1),S=r(!1);y(p,({data:e})=>{const t=k.get("currentAccountID");{const l=JSON.parse(localStorage.getItem("accounts"));if(!k.get("login_pin_token")&&k.get("login_pin_token")!==e.login_pin_token){const b=new Date;b.setDate(b.getDate()+30),k.set("login_pin_token",e.login_pin_token,{expires:(Date.parse(b)-new Date)/864e5}),l[t].login_pin_token=e.login_pin_token,l[t].login_pin_token_expires=b}a.emit("loginToken",k.get("login_pin_token")),k.set("settings_pin_token",e.settings_pin_token,0),l[t].settings_pin_token=e.settings_pin_token,localStorage.setItem("accounts",JSON.stringify(l))}a.emit("close"),c.go()}),y(h,e=>{if(typeof e!="string")for(const t in e)if(typeof e[t]!="string")for(const l in e[t])n.value.global.value=e[t][l];else n.value.global.value=e[t];else n.value.global.value=e;i.path!=="/"&&setTimeout(()=>{c.go(-1)},1e3)}),y($,e=>{for(const t in e)if(typeof e[t]!="string")for(const l in e[t])this.errors.global.value=e[t][l];else this.errors.global.value=e[t]}),y(N,e=>{e&&(S.value=!0)}),R(()=>{var e,t;(e=q.value)!=null&&e.user.email&&(m.value.email=(t=q.value)==null?void 0:t.user.email),document.documentElement.clientWidth<=425&&(v.value="315px"),window.addEventListener("resize",l=>{l.target.innerWidth<=425?v.value="315px":v.value="450px"})});const O=()=>{a.refs.pinForm.validate(e=>{e?x.checkPin(m.value):m.value.pin?n.value.global.value="PIN must be between 4 and 6 digits":n.value.global.value="This field is required"})},U=e=>{a.refs[e].focus()},j=()=>{x.forgotPin()},H=()=>{n.value.global.value=""},J=e=>{a.refs.pinForm.validateField(e,(t,l)=>{t?n.value.global.value="":n.value.global.value=l[e][0].message})};return(e,t)=>{const l=K,b=Q,W=ee,X=Z,G=A;return d(),B(G,{modelValue:f.dialogVisible,"onUpdate:modelValue":t[5]||(t[5]=_=>f.dialogVisible=_),width:v.value,height:C.value,"close-on-click-modal":!1,"text-align":"center","show-close":!1,top:"230px",class:"access_modal",onClose:t[6]||(t[6]=_=>e.$emit("close"))},{header:u(()=>[he]),default:u(()=>[be,ke,P(X,{ref:"pinForm",class:"main__form--box","hide-required-asterisk":"","show-message":!1,model:m.value,rules:L.value,onSubmit:z(O,["prevent"])},{default:u(()=>[n.value.global.value?(d(),w("div",ye,[o("div",we,[xe,o("span",null,D(n.value.global.value),1)]),o("span",{class:"clear-error",onClick:H},"X")])):g("",!0),P(b,{prop:"pin",class:"password-form-item"},{default:u(()=>[P(l,{id:"pin",ref:"pin",modelValue:m.value.pin,"onUpdate:modelValue":t[2]||(t[2]=_=>m.value.pin=_),type:V.value?"text":"password",class:"main__form--box__input",placeholder:"Enter PIN",autofocus:"",onBlur:t[3]||(t[3]=_=>J("pin"))},{suffix:u(()=>[m.value.pin?(d(),w("div",{key:0,style:{position:"relative"},onClick:t[0]||(t[0]=_=>U("pin"))},Ee)):g("",!0),o("img",{src:V.value?s(ne):s(re),alt:"eye_icon",onClick:t[1]||(t[1]=_=>V.value=!V.value)},null,8,Ie)]),_:1},8,["modelValue","type"])]),_:1}),o("div",$e,[P(W,{style:{"font-size":"14px","font-weight":"400"},onClick:j},{default:u(()=>[le("Forgot PIN?")]),_:1})]),P(W,{class:"submit-button","native-type":"submit",loading:s(T)},{default:u(()=>[o("span",Ve,D(s(T)?"":"NEXT"),1)]),_:1},8,["loading"])]),_:1},8,["model","rules","onSubmit"]),S.value?(d(),B(ve,{key:0,email:m.value.email,"dialog-visible":S.value,"append-to-body":!0,onClose:t[4]||(t[4]=_=>S.value=!1)},null,8,["email","dialog-visible"])):g("",!0)]),_:1},8,["modelValue","width","height"])}}};export{Te as _,ve as a};
