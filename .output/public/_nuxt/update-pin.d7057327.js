import{E as oe,_ as h,a as ie,b as se}from"./el-overlay.303db8d7.js";import{E as ne}from"./el-button.a9620db7.js";import{D as te,b as re,s as R,e as le,r as f,w as N,f as ae,i as d,j as t,u as o,k as _,l as p,m as ue,c as y,p as u,q as pe,o as a,t as H,B as T,A as de,x as me,y as ve,z as fe}from"./entry.4919aef1.js";import{_ as _e}from"./chevron-left.0d5cc3ef.js";import{E as F}from"./ErrorMassageModal.6cc8bcf1.js";import{a as ce,_ as ge}from"./AccessCheckModal.afca23e5.js";import{h as B,s as D}from"./eye-close-icon.a59f8c16.js";import be from"./settingsToken.596def1f.js";import we from"./loginToken.a615bdfb.js";import ye from"./auth.8d4f467f.js";import{_ as ke}from"./_plugin-vue_export-helper.c27b6911.js";import"./focus-trap.a4932e6f.js";import"./email-primary-icon.d7579889.js";const c=k=>(me("data-v-bde2596d"),k=k(),ve(),k),Se={class:"main"},$e={class:"main__form"},Ie={class:"main__form--title"},Pe=c(()=>t("span",null,"Reset PIN",-1)),xe=c(()=>t("div",{class:"main__form--subtitle"},"Fill in the fields to change your PIN.",-1)),Ne={key:0,class:"el-form-item__global-error-container"},he={class:"el-form-item__global-error"},Ce=c(()=>t("img",{src:h,alt:""},null,-1)),Ee=c(()=>t("span",{for:"previous",class:"custom_placeholder"}," Old PIN ",-1)),Ve=[Ee],Me=["src"],Te={key:0,class:"el-form-item__error"},Fe=["innerHTML"],Be=c(()=>t("div",null,null,-1)),De=c(()=>t("span",{for:"pin",class:"custom_placeholder"}," New PIN ",-1)),qe=[De],Le=["src"],Re={key:0,class:"el-form-item__error"},He=["innerHTML"],ze=c(()=>t("div",null,null,-1)),Oe=c(()=>t("span",{for:"password",class:"custom_placeholder"}," Repeat PIN ",-1)),je=[Oe],Ae=["src"],Ue={key:0,class:"el-form-item__error"},We=["innerHTML"],Xe=c(()=>t("div",null,null,-1)),Ge={class:"forgot-password"},Je={class:"submit-button__text"},Ke={__name:"update-pin",setup(k){const C=te(),z=re(),{resetPinFailureData:O,resetPinData:j,forgotPinFailureData:A,forgotPinData:U,isLoadingSubmit:q}=R(C),{profileSuccessData:E}=R(z),S=pe(),W=le(),X=(s,e,r)=>{e===""?r(new Error("Please input the PIN again")):e!==l.value.pin?r(new Error("PIN and repeat PIN do not match.")):r()},G=(s,e,r)=>{/^\d{4,6}$/.test(e)?r():r(new Error(`<span>PIN is improperly formatted.<br></span>
            <ul class="error_info">
              <li>4-6 characters long.</li>
              <li>Should include only numbers.</li>
            </ul>`))},l=f({previous:null,pin:null,pin_confirmation:null}),$=f(!1),I=f(!1),P=f(!1),b=f(!1),w=f(!1),V=f(!1),i=f({previous:{value:"",isShow:!1},pin:{value:"",isShow:!1},pin_confirmation:{value:"",isShow:!1},global:{value:""}}),J=f({previous:[{required:!0,message:"This field is required.",trigger:"blur"}],pin:[{required:!0,message:"This field is required.",trigger:"blur"},{validator:G,trigger:"blur"}],pin_confirmation:[{required:!0,message:"This field is required.",trigger:"blur"},{validator:X,trigger:"blur"}]});N(O,s=>{for(const e in s)if(typeof s[e]!="string")for(const r in s[e])i.value.global.value=s[e][r];else i.value.global.value=s[e]}),N(j,s=>{s&&fe("/")}),N(A,s=>{if(!b.value)for(const e in s)if(typeof s[e]!="string")for(const r in s[e])i.value.global.value=s[e][r];else i.value.global.value=s[e]}),N(U,s=>{s&&(b.value=!0)}),ae(()=>{var s,e;ye(),w.value=we(),w.value=be(),(s=E.value)!=null&&s.user.email&&(l.value.email=(e=E.value)==null?void 0:e.user.email),window.addEventListener("resize",Z())});const K=()=>{C.resetPin(l.value)},Q=()=>{var s;l.value.email=(s=E.value)==null?void 0:s.user.email,C.forgotPin()},g=s=>{S.refs.pinForm.validateField(s,(e,r)=>{e?i.value[s].value="":i.value[s].value=r[s][0].message}),Object.values(l.value).every(e=>e)?S.refs.pinForm.validate(e=>V.value=e):V.value=!1},Y=()=>{i.value.global.value=""},m=()=>window.innerWidth>990,Z=()=>{S.update()},v=(s,e)=>{m()?i.value[s].isShow=e==="mouseover":e==="click"&&(i.value[s].isShow=!0)},M=s=>{S.refs[s].focus()};return(s,e)=>{const r=ie,x=se,L=ne,ee=oe;return a(),d("div",Se,[t("div",$e,[t("div",Ie,[t("img",{src:_e,alt:"chevron-left",onClick:e[0]||(e[0]=n=>o(W).go(-1))}),Pe]),xe,_(ee,{ref:"pinForm",class:"main__form--box","hide-required-asterisk":"",model:o(l),rules:o(J),onSubmit:ue(K,["prevent"])},{default:p(()=>[o(i).global.value?(a(),d("div",Ne,[t("div",he,[Ce,t("span",null,H(o(i).global.value),1)]),t("span",{class:"clear-error",onClick:Y},"X")])):u("",!0),_(x,{prop:"previous",class:"password-form-item"},{error:p(()=>[o(i).previous.isShow&&m()?(a(),d("div",Te,[t("span",{innerHTML:o(i).previous.value},null,8,Fe)])):u("",!0),Be]),default:p(()=>[_(r,{id:"previous",ref:"previous",modelValue:o(l).previous,"onUpdate:modelValue":e[6]||(e[6]=n=>o(l).previous=n),type:o($)?"text":"password",class:"main__form--box__input",placeholder:"Old PIN",onInput:e[7]||(e[7]=n=>g("previous")),onBlur:e[8]||(e[8]=n=>g("previous"))},{suffix:p(()=>[o(l).previous?(a(),d("div",{key:0,style:{position:"relative"},onClick:e[1]||(e[1]=n=>M("previous"))},Ve)):u("",!0),t("img",{class:T(o(i).previous.value?"eye_icon":""),src:o($)?o(B):o(D),alt:"eye_icon",onClick:e[2]||(e[2]=n=>$.value=!o($))},null,10,Me),o(i).previous.value?(a(),d("img",{key:1,src:h,alt:"",class:"error_icon",onMouseover:e[3]||(e[3]=n=>v("previous","mouseover")),onMouseout:e[4]||(e[4]=n=>v("previous","mouseout")),onClick:e[5]||(e[5]=n=>v("previous","click"))},null,32)):u("",!0)]),_:1},8,["modelValue","type"])]),_:1}),_(x,{prop:"pin",class:"password-form-item"},{error:p(()=>[o(i).pin.isShow&&m()?(a(),d("div",Re,[t("span",{innerHTML:o(i).pin.value},null,8,He)])):u("",!0),ze]),default:p(()=>[_(r,{id:"pin",ref:"pin",modelValue:o(l).pin,"onUpdate:modelValue":e[14]||(e[14]=n=>o(l).pin=n),type:o(I)?"text":"password",class:"main__form--box__input",placeholder:"New PIN",onInput:e[15]||(e[15]=n=>g("pin")),onBlur:e[16]||(e[16]=n=>g("pin"))},{suffix:p(()=>[o(l).pin?(a(),d("div",{key:0,style:{position:"relative"},onClick:e[9]||(e[9]=n=>M("pin"))},qe)):u("",!0),t("img",{class:T(o(i).pin.value?"eye_icon":""),src:o(I)?o(B):o(D),alt:"eye_icon",onClick:e[10]||(e[10]=n=>I.value=!o(I))},null,10,Le),o(i).pin.value?(a(),d("img",{key:1,src:h,alt:"",class:"error_icon",onMouseover:e[11]||(e[11]=n=>v("pin","mouseover")),onMouseout:e[12]||(e[12]=n=>v("pin","mouseout")),onClick:e[13]||(e[13]=n=>v("pin","click"))},null,32)):u("",!0)]),_:1},8,["modelValue","type"])]),_:1}),_(x,{prop:"pin_confirmation",class:"password-form-item"},{error:p(()=>[!o(i).pin_confirmation.isShow&&m()?(a(),d("div",Ue,[t("span",{innerHTML:o(i).pin_confirmation.value},null,8,We)])):u("",!0),Xe]),default:p(()=>[_(r,{id:"pin_confirmation",ref:"pin_confirmation",modelValue:o(l).pin_confirmation,"onUpdate:modelValue":e[22]||(e[22]=n=>o(l).pin_confirmation=n),type:o(P)?"text":"password",class:"main__form--box__input",placeholder:"Repeat PIN",onInput:e[23]||(e[23]=n=>g("pin_confirmation")),onBlur:e[24]||(e[24]=n=>g("pin_confirmation"))},{suffix:p(()=>[o(l).pin_confirmation?(a(),d("div",{key:0,style:{position:"relative"},onClick:e[17]||(e[17]=n=>M("pin_confirmation"))},je)):u("",!0),t("img",{class:T(o(i).pin_confirmation.value?"eye_icon":""),src:o(P)?o(B):o(D),alt:"eye_icon",onClick:e[18]||(e[18]=n=>P.value=!o(P))},null,10,Ae),o(i).pin_confirmation.value?(a(),d("img",{key:1,src:h,alt:"",class:"error_icon",onMouseover:e[19]||(e[19]=n=>v("pin_confirmation","mouseover")),onMouseout:e[20]||(e[20]=n=>v("pin_confirmation","mouseout")),onClick:e[21]||(e[21]=n=>v("pin_confirmation","click"))},null,32)):u("",!0)]),_:1},8,["modelValue","type"])]),_:1}),t("div",Ge,[_(L,{style:{"font-size":"14px","font-weight":"400"},onClick:Q},{default:p(()=>[de("Forgot PIN?")]),_:1})]),_(L,{class:"submit-button","native-type":"submit",loading:o(q),disabled:!o(V)},{default:p(()=>[t("span",Je,H(o(q)?"":"Save"),1)]),_:1},8,["loading","disabled"]),o(i).previous.isShow&&!m()?(a(),y(F,{key:1,"dialog-visible":o(i).previous.isShow&&!m(),"error-text":o(i).previous.value,onVisible:e[25]||(e[25]=n=>o(i).previous.isShow=!1)},null,8,["dialog-visible","error-text"])):u("",!0),o(i).pin.isShow&&!m()?(a(),y(F,{key:2,"dialog-visible":o(i).pin.isShow&&!m(),"error-text":o(i).pin.value,onVisible:e[26]||(e[26]=n=>o(i).pin.isShow=!1)},null,8,["dialog-visible","error-text"])):u("",!0),o(i).pin_confirmation.isShow&&!m()?(a(),y(F,{key:3,"dialog-visible":o(i).pin_confirmation.isShow&&!m(),"error-text":o(i).pin_confirmation.value,onVisible:e[27]||(e[27]=n=>o(i).pin_confirmation.isShow=!1)},null,8,["dialog-visible","error-text"])):u("",!0)]),_:1},8,["model","rules","onSubmit"])]),o(b)?(a(),y(ce,{key:0,email:o(l).email,"dialog-visible":o(b),onClose:e[28]||(e[28]=n=>b.value=!1)},null,8,["email","dialog-visible"])):u("",!0),o(w)?(a(),y(ge,{key:1,"dialog-visible":o(w),onClose:e[29]||(e[29]=n=>w.value=!1)},null,8,["dialog-visible"])):u("",!0)])}}},po=ke(Ke,[["__scopeId","data-v-bde2596d"]]);export{po as default};
